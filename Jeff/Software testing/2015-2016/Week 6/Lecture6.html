<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0070)http://homepages.cwi.nl/~jve/courses/15/testing/lectures/Lecture6.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta name="generator" content="pandoc">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="./Lecture6_files/buttondown.css" type="text/css">
  <script src="./Lecture6_files/MathJax.js" type="text/javascript"></script>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.0') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?rev=2.6.0') format('woff'), url('https://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?rev=2.6.0') format('opentype')}
</style></head>
<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<h1 id="lecture-6-fast-modular-arithmetic-and-public-key-cryptography">Lecture 6: Fast Modular Arithmetic and Public Key Cryptography</h1>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="kw">module</span> <span class="dt">Lecture6</span>
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> <span class="kw">where</span> 
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Data.List</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">System.Random</span></code></pre></div>
<p><strong>Abstract</strong></p>
<p>Fast modular arithmetic allows us to generate and recognize large primes efficiently, but we need the concept of a <em>probabilistic algorithm</em>.</p>
<p>Given two large primes <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">p</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.49em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">q</script></span>, computing their product <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" role="math" style="width: 1.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.97em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">pq</script></span> is easy, but finding the two factors from the semi-prime <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-11" role="math" style="width: 1.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.97em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">pq</script></span> is (believed to be) hard. No fast algorithm for this is known.</p>
<p>These facts have important consequences for cryptography. The lecture gives an introduction to fast modular arithmetic, to probabilistic algorithms for primality testing, and to their application in public key cryptography. The lecture also prepares for the lab exercises of this week.</p>
<p>For background, see also Chapter 33 of <span class="citation">(Cormen, Leiserson, and Rivest 1997)</span>, on number-theoretic algorithms.</p>
<hr>
<p><strong>Factorization</strong></p>
<p>Here is a naive factorization algorithm:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; factors_naive ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> [<span class="dt">Integer</span>]
<span class="ot">&gt;</span> factors_naive n <span class="fu">=</span> factors' n <span class="dv">2</span> <span class="kw">where</span> 
<span class="ot">&gt;</span>   factors' <span class="dv">1</span> _ <span class="fu">=</span> []
<span class="ot">&gt;</span>   factors' n m 
<span class="ot">&gt;</span>     <span class="fu">|</span> n <span class="ot">`mod`</span> m <span class="fu">==</span> <span class="dv">0</span> <span class="fu">=</span> m <span class="fu">:</span> factors' (n <span class="ot">`div`</span> m) m
<span class="ot">&gt;</span>     <span class="fu">|</span> otherwise      <span class="fu">=</span>     factors' n (m<span class="fu">+</span><span class="dv">1</span>)</code></pre></div>
<p>This gives:</p>
<pre><code> *Lecture6&gt; factors_naive 362880
 [2,2,2,2,2,2,2,3,3,3,3,5,7]
 *Lecture6&gt; factors_naive 524287
 [524287]</code></pre>
<p><strong>Improvement</strong></p>
<p>This can be improved slightly by only trying candidate factors that are primes:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; factors ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> [<span class="dt">Integer</span>]
<span class="ot">&gt;</span> factors n <span class="fu">=</span> <span class="kw">let</span> 
<span class="ot">&gt;</span>    ps <span class="fu">=</span> takeWhile (\m <span class="ot">-&gt;</span> m<span class="fu">^</span><span class="dv">2</span> <span class="fu">&lt;=</span> n) primes
<span class="ot">&gt;</span>  <span class="kw">in</span> factors' n ps <span class="kw">where</span> 
<span class="ot">&gt;</span>    factors' <span class="dv">1</span> _  <span class="fu">=</span> []
<span class="ot">&gt;</span>    factors' n [] <span class="fu">=</span> [n]
<span class="ot">&gt;</span>    factors' n (p<span class="fu">:</span>ps) 
<span class="ot">&gt;</span>     <span class="fu">|</span> n <span class="ot">`mod`</span> p <span class="fu">==</span> <span class="dv">0</span> <span class="fu">=</span> p<span class="fu">:</span> factors' (n <span class="ot">`div`</span> p) (p<span class="fu">:</span>ps)
<span class="ot">&gt;</span>     <span class="fu">|</span> otherwise      <span class="fu">=</span>    factors' n ps</code></pre></div>
<p>To implement <code>primes</code> we can use <code>factors</code> itself:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> isPrime n <span class="fu">=</span> factors n <span class="fu">==</span> [n]
<span class="ot">&gt;</span> primes <span class="fu">=</span> <span class="dv">2</span> <span class="fu">:</span> filter isPrime [<span class="dv">3</span><span class="fu">..</span>]</code></pre></div>
<p><em>Review Question</em>: What is wrong with the definition <code>primes = filter isPrime [2..]</code>?</p>
<p><strong>Comparison</strong></p>
<p>To compare the two versions, try this out with:</p>
<pre><code> *Lecture6&gt; map factors [m8..]

 *Lecture6&gt; map factors_naive [m8..]</code></pre>
<p>Here <code>m8</code> is the eighth Mersenne prime (see below).</p>
<p>Despite this improvement, it is generally believed that factorization of numbers with large factors is hard.</p>
<p>No efficient algorithm for factorization is known. All existing methods use trial division with large numbers of candidates.</p>
<p><strong>Primality Testing Using Factorisation</strong></p>
<p>The test <code>isPrime n = factors n == [n]</code> is <em>100 percent reliable</em> but <em>inefficient</em>, because it is essentially based on trial and error.</p>
<p>The question is: can we do better?</p>
<p>It turns out that <em>for primality testing we can</em>, but it seems that <em>for factorization we cannot</em>.</p>
<p>These facts have important implications for cryptography, as we will explain in today's lecture.</p>
<p><strong>Mersenne Primes</strong></p>
<div class="figure">
<img src="./Lecture6_files/Mersenne.jpg" alt="Marin Mersenne (1588--1647)">
<p class="caption">Marin Mersenne (1588--1647)</p>
</div>
<p>Father Marin Mersenne was a French priest and amateur mathematician. He discovered some large primes by studying numbers of the form <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" role="math" style="width: 2.855em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.734em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.67em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-16"><span class="msubsup" id="MathJax-Span-17"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-18" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.488em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>p</mi></msup><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-5">2^p - 1</script></span>. Such primes are called Mersenne primes.</p>
<p><strong>The first 25 Mersenne primes</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> m1  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">2</span><span class="fu">-</span><span class="dv">1</span>;    m2  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">3</span><span class="fu">-</span><span class="dv">1</span>;     m3  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">5</span><span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span> m4  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">7</span><span class="fu">-</span><span class="dv">1</span>;    m5  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">13</span><span class="fu">-</span><span class="dv">1</span>;    m6  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">17</span><span class="fu">-</span><span class="dv">1</span> 
<span class="ot">&gt;</span> m7  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">19</span><span class="fu">-</span><span class="dv">1</span>;   m8  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">31</span><span class="fu">-</span><span class="dv">1</span>;    m9  <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">61</span><span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span> m10 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">89</span><span class="fu">-</span><span class="dv">1</span>;   m11 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">107</span><span class="fu">-</span><span class="dv">1</span>;   m12 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">127</span><span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span> m13 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">521</span><span class="fu">-</span><span class="dv">1</span>;  m14 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">607</span><span class="fu">-</span><span class="dv">1</span>;   m15 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">1279</span><span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span> m16 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">2203</span><span class="fu">-</span><span class="dv">1</span>; m17 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">2281</span><span class="fu">-</span><span class="dv">1</span>;  m18 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">3217</span><span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span> m19 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">4253</span><span class="fu">-</span><span class="dv">1</span>; m20 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">4423</span><span class="fu">-</span><span class="dv">1</span>;  m21 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">9689</span><span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span> m22 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">9941</span><span class="fu">-</span><span class="dv">1</span>; m23 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">11213</span><span class="fu">-</span><span class="dv">1</span>; m24 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">19937</span><span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span> m25 <span class="fu">=</span> <span class="dv">2</span><span class="fu">^</span><span class="dv">21701</span><span class="fu">-</span><span class="dv">1</span></code></pre></div>
<p><span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" role="math" style="width: 2.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.794em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.73em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-23"><span class="msubsup" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-25" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.488em;"><span class="mi" id="MathJax-Span-26" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">2^n-1</script></span> can only be prime if <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-29" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">n</script></span> is also prime (Exercise 3.36 in <span class="citation">(Doets and Eijck 2012)</span>).</p>
<p>Print out <code>m25</code> to see that it is a <em>huge</em> beast.</p>
<p><strong>Modular Arithmetic</strong></p>
<div class="figure">
<img src="./Lecture6_files/clock_noarrows.jpg" alt="Clock Arithmetic">
<p class="caption">Clock Arithmetic</p>
</div>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;15&lt;/mn&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32" role="math" style="width: 12.806em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.442em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1012.38em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-33"><span class="mn" id="MathJax-Span-34" style="font-family: MathJax_Main;">11</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.246em;">+</span><span class="mn" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.246em;">4</span><span class="mo" id="MathJax-Span-37" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.306em;">15</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.306em;">3</span><span class="TeXmathchoice" id="MathJax-Span-41"><span class="mspace" id="MathJax-Span-42" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-45" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.185em;">12</span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>11</mn><mo>+</mo><mn>4</mn><mo>=</mo><mn>15</mn><mo>≡</mo><mn>3</mn><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mn>12</mn><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">
    11 + 4 = 15 \equiv 3 \pmod {12}.
</script></span></p>
<p><strong>Operations for modular addition, multiplication</strong></p>
<p>Modular addition:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; addM ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> addM x y <span class="fu">=</span> rem (x<span class="fu">+</span>y)</code></pre></div>
<p>Modular multiplication:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; multM ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> multM x y <span class="fu">=</span> rem (x<span class="fu">*</span>y) </code></pre></div>
<p><strong>Modular division, modular inverse</strong></p>
<p>Modular division is the same as multiplication by modular inverse. Modular inverses only exist for numbers that are co-prime with their modulus.</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; invM ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> invM x n <span class="fu">=</span> <span class="kw">let</span> 
<span class="ot">&gt;</span>    (u,v) <span class="fu">=</span> fct_gcd x n
<span class="ot">&gt;</span>    copr  <span class="fu">=</span> x<span class="fu">*</span>u <span class="fu">+</span> v<span class="fu">*</span>n <span class="fu">==</span> <span class="dv">1</span>
<span class="ot">&gt;</span>    i     <span class="fu">=</span> <span class="kw">if</span> signum u <span class="fu">==</span> <span class="dv">1</span> <span class="kw">then</span> u <span class="kw">else</span> u <span class="fu">+</span> n  
<span class="ot">&gt;</span>  <span class="kw">in</span> 
<span class="ot">&gt;</span>    <span class="kw">if</span> copr <span class="kw">then</span> i <span class="kw">else</span> error <span class="st">"no inverse"</span></code></pre></div>
<p>This uses the extended Euclidean algorithm for GCD.</p>
<p><strong>The Extended Euclidean Algorithm</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; fct_gcd ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> (<span class="dt">Integer</span>,<span class="dt">Integer</span>) 
<span class="ot">&gt;</span> fct_gcd a b <span class="fu">=</span> 
<span class="ot">&gt;</span>   <span class="kw">if</span> b <span class="fu">==</span> <span class="dv">0</span> 
<span class="ot">&gt;</span>   <span class="kw">then</span> (<span class="dv">1</span>,<span class="dv">0</span>) 
<span class="ot">&gt;</span>   <span class="kw">else</span> 
<span class="ot">&gt;</span>      <span class="kw">let</span> 
<span class="ot">&gt;</span>        (q,r) <span class="fu">=</span> quotRem a b
<span class="ot">&gt;</span>        (s,t) <span class="fu">=</span> fct_gcd b r 
<span class="ot">&gt;</span>      <span class="kw">in</span> (t, s <span class="fu">-</span> q<span class="fu">*</span>t)</code></pre></div>
<p><strong>Modular Exponentiation</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; expM ::</span>  <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> expM x y <span class="fu">=</span> rem (x<span class="fu">^</span>y)</code></pre></div>
<p>This is not efficient, for we first compute <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-49" role="math" style="width: 1.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.124em 1001.04em 1.156em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-50"><span class="msubsup" id="MathJax-Span-51"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>y</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-9">x^y</script></span>, and then reduce the result modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-54" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">N</script></span>.</p>
<p>Instead, we should have performed the intermediate computation steps for <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" role="math" style="width: 1.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.124em 1001.04em 1.156em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-58"><span class="msubsup" id="MathJax-Span-59"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>y</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-11">x^y</script></span> modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-62" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">N</script></span>.</p>
<p><strong>Modular Exponentiation, Fast Version</strong></p>
<p>One of your exercises for this week's lab session is to implement a function that does modular exponentiation of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" role="math" style="width: 1.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.124em 1001.04em 1.156em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-66"><span class="msubsup" id="MathJax-Span-67"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>y</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-13">x^y</script></span> in polynomial time, by repeatedly squaring modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-70" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">N</script></span>.</p>
<p>E.g., <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-73" role="math" style="width: 4.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.372em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1004.31em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-74"><span class="msubsup" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="mn" id="MathJax-Span-79" style="font-size: 70.7%; font-family: MathJax_Main;">33</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mn" id="MathJax-Span-81" style="font-family: MathJax_Main;">5</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-15">x^{33} \bmod 5</script></span> can be computed by means of</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mn&gt;5.&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-82" role="math" style="width: 15.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.173em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1015.11em 2.37em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-83"><span class="msubsup" id="MathJax-Span-84"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-86"><span class="mrow" id="MathJax-Span-87"><span class="mn" id="MathJax-Span-88" style="font-size: 70.7%; font-family: MathJax_Main;">33</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mn" id="MathJax-Span-90" style="font-family: MathJax_Main;">5</span><span class="mo" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-92" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-94"><span class="mrow" id="MathJax-Span-95"><span class="mn" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mn" id="MathJax-Span-98" style="font-family: MathJax_Main;">5</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic; padding-left: 0.246em;">x</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mn" id="MathJax-Span-102" style="font-family: MathJax_Main;">5.</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mn>5</mn><mo>=</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mn>5</mn><mo>×</mo><mi>x</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mn>5.</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">
  x^{33} \bmod 5 = x^{32} \bmod 5 \times x \bmod 5. 
</script></span></p>
<p><span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" role="math" style="width: 6.01em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.828em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1005.71em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-104"><span class="msubsup" id="MathJax-Span-105"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mn" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-110"><span class="mspace" id="MathJax-Span-111" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-113" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-114" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msup><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">x^{32} \pmod N</script></span> is computed in five steps by means of repeatedly squaring modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">N</script></span>:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-120" role="math" style="width: 25.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.185em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1025.12em 2.37em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-121"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main; padding-left: 0.306em;">→</span><span class="msubsup" id="MathJax-Span-126" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="mn" id="MathJax-Span-128" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main; padding-left: 0.306em;">→</span><span class="msubsup" id="MathJax-Span-132" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main; padding-left: 0.306em;">→</span><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.306em;">…</span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.306em;">→</span><span class="msubsup" id="MathJax-Span-140" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-142"><span class="mrow" id="MathJax-Span-143"><span class="mn" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>N</mi><mo stretchy="false">→</mo><msup><mi>x</mi><mn>2</mn></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>N</mi><mo stretchy="false">→</mo><msup><mi>x</mi><mn>4</mn></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>N</mi><mo stretchy="false">→</mo><mo>…</mo><mo stretchy="false">→</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>N</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">
  x \bmod N \rightarrow x^2 \bmod N \rightarrow  x^4 \bmod N \rightarrow  \ldots 
   \rightarrow  x^{32} \bmod N.
</script></span></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; exM ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> exM <span class="fu">=</span> expM <span class="co">-- to be replaced by a fast version</span></code></pre></div>
<p><strong>Fermat's Test for Primality</strong></p>
<div class="figure">
<img src="./Lecture6_files/P_deFermat.jpg" alt="">

</div>
<p>Primality testing using a probabilistic algorithm is based on efficient exponentiation modulo.</p>
<p>This uses a theorem by the famous French mathematician Pierre de Fermat (1601--1665).</p>
<p><strong>Fermat's Little Theorem</strong></p>
<p>The following is called the <a href="https://en.wikipedia.org/wiki/Fermat&#39;s_little_theorem">Little Theorem of Fermat</a>, to distinguish it from Fermat's famous Last Theorem. (Fermat's <a href="https://en.wikipedia.org/wiki/Fermat&#39;s_Last_Theorem">Last Theorem</a> says that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-148" role="math" style="width: 6.01em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.828em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1005.83em 2.552em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-149"><span class="msubsup" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 1.095em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main; padding-left: 0.246em;">+</span><span class="msubsup" id="MathJax-Span-154" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-158" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math-italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>n</mi></msup><mo>+</mo><msup><mi>y</mi><mi>n</mi></msup><mo>=</mo><msup><mi>z</mi><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-20">x^n + y^n = z^n</script></span> has no non-zero integer solutions for natural numbers <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-161" role="math" style="width: 2.552em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.491em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.43em 2.37em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main; padding-left: 0.306em;">&gt;</span><span class="mn" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.306em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>&gt;</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-21">n> 2</script></span>. Fermat had stated this without proof. A proof was found by Andrew Wiles in 1995.)</p>
<p><strong>Fermat</strong>: If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-166" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-167"><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">p</script></span> is prime, then for every integer <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-169" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">a</script></span> with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-172" role="math" style="width: 4.433em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.311em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1004.31em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-173"><span class="mn" id="MathJax-Span-174" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-175" style="font-family: MathJax_Main; padding-left: 0.306em;">≤</span><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mi>a</mi><mo>&lt;</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">1 \leq a < p</script></span>: <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" role="math" style="width: 8.134em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.891em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1007.77em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-180"><span class="msubsup" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-188" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-189" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="TeXmathchoice" id="MathJax-Span-190"><span class="mspace" id="MathJax-Span-191" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-194" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><mn>1</mn><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>p</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">a^{p-1} \equiv 1 \pmod p</script></span>.</p>
<p><strong>Some Examples</strong></p>
<p>To see what Fermat's Little Theorem says, look at some examples: Assume <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-197" role="math" style="width: 2.491em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.37em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-200" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-201" style="font-family: MathJax_Main; padding-left: 0.306em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-26">p = 5</script></span>. Let us check <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-202" role="math" style="width: 1.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.058em 1000.97em 1.156em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-203"><span class="msubsup" id="MathJax-Span-204"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-205" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.488em;"><span class="mn" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-27">2^4</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" role="math" style="width: 1.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.058em 1000.97em 1.156em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-208"><span class="msubsup" id="MathJax-Span-209"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-210" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.488em;"><span class="mn" id="MathJax-Span-211" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>3</mn><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-28">3^4</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-212" role="math" style="width: 1.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.118em 1000.97em 1.156em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-213"><span class="msubsup" id="MathJax-Span-214"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-215" style="font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.488em;"><span class="mn" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>4</mn><mn>4</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-29">4^4</script></span>.</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;81&lt;/mn&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;256&lt;/mn&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-217" role="math" style="width: 32.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.132em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1031.07em 2.612em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-218"><span class="msubsup" id="MathJax-Span-219"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-220" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.488em;"><span class="mn" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-223" style="font-family: MathJax_Main; padding-left: 0.306em;">16</span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-225" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="TeXmathchoice" id="MathJax-Span-226"><span class="mspace" id="MathJax-Span-227" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-230" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-231" style="font-family: MathJax_Main; padding-left: 0.185em;">5</span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-234" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-235" style="font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.488em;"><span class="mn" id="MathJax-Span-236" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-237" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-238" style="font-family: MathJax_Main; padding-left: 0.306em;">81</span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-240" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="TeXmathchoice" id="MathJax-Span-241"><span class="mspace" id="MathJax-Span-242" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-245" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-246" style="font-family: MathJax_Main; padding-left: 0.185em;">5</span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-248" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-249" style="padding-left: 0.185em;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-250" style="font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.488em;"><span class="mn" id="MathJax-Span-251" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-253" style="font-family: MathJax_Main; padding-left: 0.306em;">256</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-255" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="TeXmathchoice" id="MathJax-Span-256"><span class="mspace" id="MathJax-Span-257" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-260" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-261" style="font-family: MathJax_Main; padding-left: 0.185em;">5</span><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mn>2</mn><mn>4</mn></msup><mo>=</mo><mn>16</mn><mo>≡</mo><mn>1</mn><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mn>5</mn><mo stretchy="false">)</mo><mo>,</mo><msup><mn>3</mn><mn>4</mn></msup><mo>=</mo><mn>81</mn><mo>≡</mo><mn>1</mn><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mn>5</mn><mo stretchy="false">)</mo><mo>,</mo><msup><mn>4</mn><mn>4</mn></msup><mo>=</mo><mn>256</mn><mo>≡</mo><mn>1</mn><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mn>5</mn><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">
  2^4 = 16 \equiv 1 \pmod 5, 
  3^4 = 81 \equiv 1 \pmod 5, 
  4^4 = 256 \equiv 1 \pmod 5. 
</script></span></p>
<p>Next, use Haskell to check for a larger prime:</p>
<pre><code>  *Lecture6&gt; [ a^28 `mod` 29 | a &lt;- [1..28] ]
  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]</code></pre>
<p>It turns out that for every <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-264" role="math" style="width: 4.433em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.311em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1004.31em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-265"><span class="mn" id="MathJax-Span-266" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main; padding-left: 0.306em;">≤</span><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>≤</mo><mi>a</mi><mo>&lt;</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">1 \leq a < p</script></span>, the set of remainders modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-271" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">p</script></span> is equal to their product with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-274" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">a</script></span> modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-277" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">p</script></span>. In other words, multiplying the set <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-280" role="math" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.071em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1006.01em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-281"><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-283" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main; padding-left: 0.185em;">…</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main; padding-left: 0.185em;">,</span><span class="mi" id="MathJax-Span-287" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-289" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-35">\{ 1, \ldots, p-1 \}</script></span> with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-291" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">a</script></span> modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-294" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">p</script></span> is simply to permute the set.</p>
<p>Let's try this out with Haskell:</p>
<pre><code>  Prelude Lecture6&gt; [n `mod` 13 | n &lt;- [1..12] ]
  [1,2,3,4,5,6,7,8,9,10,11,12]
  Prelude Lecture6&gt; [2*n `mod` 13 | n &lt;- [1..12] ]
  [2,4,6,8,10,12,1,3,5,7,9,11]
  Prelude Lecture6&gt; [3*n `mod` 13 | n &lt;- [1..12] ]
  [3,6,9,12,2,5,8,11,1,4,7,10]
  Prelude Lecture6&gt; [4*n `mod` 13 | n &lt;- [1..12] ]
  [4,8,12,3,7,11,2,6,10,1,5,9]
  Prelude Lecture6&gt; [5*n `mod` 13 | n &lt;- [1..12] ]
  [5,10,2,7,12,4,9,1,6,11,3,8]
  Prelude Lecture6&gt; [6*n `mod` 13 | n &lt;- [1..12] ]
  [6,12,5,11,4,10,3,9,2,8,1,7]
  Prelude Lecture6&gt; [7*n `mod` 13 | n &lt;- [1..12] ]
  [7,1,8,2,9,3,10,4,11,5,12,6]
  Prelude Lecture6&gt; [8*n `mod` 13 | n &lt;- [1..12] ]
  [8,3,11,6,1,9,4,12,7,2,10,5]
  Prelude Lecture6&gt; [9*n `mod` 13 | n &lt;- [1..12] ]
  [9,5,1,10,6,2,11,7,3,12,8,4]</code></pre>
<p>Take the case with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-297" role="math" style="width: 3.037em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.916em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.86em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-298"><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-301" style="font-family: MathJax_Main; padding-left: 0.306em;">13</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>=</mo><mn>13</mn></math></span></span><script type="math/tex" id="MathJax-Element-38">p = 13</script></span>. Multiplying the numbers in the set ${ 1, , 12 }* and the numbers in the set <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-302" role="math" style="width: 13.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.171em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1013.11em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-303"><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-305" style="font-family: MathJax_Main;">5</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mn" id="MathJax-Span-308" style="font-family: MathJax_Main;">13</span><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Main; padding-left: 0.306em;">∣</span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">n</span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main; padding-left: 0.306em;">∈</span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main; padding-left: 0.306em;">{</span><span class="mn" id="MathJax-Span-313" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-314" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main; padding-left: 0.185em;">…</span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main; padding-left: 0.185em;">,</span><span class="mn" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.185em;">12</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>5</mn><mi>n</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mn>13</mn><mo>∣</mo><mi>n</mi><mo>∈</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mn>12</mn><mo fence="false" stretchy="false">}</mo><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">\{ 5n \bmod 13 \mid n \in \{ 1, \ldots, 12 \} \}</script></span> we get the same outcome:</p>
<pre><code>  *Lecture6&gt; product [1..12]
  479001600
  *Lecture6&gt; product (map (\ n -&gt; 5*n `mod` 13) [1..12])
  479001600</code></pre>
<p>Dividing both sides by <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-320" role="math" style="width: 1.399em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1001.28em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-321"><span class="mn" id="MathJax-Span-322" style="font-family: MathJax_Main;">12</span><span class="mo" id="MathJax-Span-323" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>12</mn><mo>!</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">12!</script></span>, this gives <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-324" role="math" style="width: 6.921em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.678em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1006.62em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-325"><span class="msubsup" id="MathJax-Span-326"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-327" style="font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.488em;"><span class="texatom" id="MathJax-Span-328"><span class="mrow" id="MathJax-Span-329"><span class="mn" id="MathJax-Span-330" style="font-size: 70.7%; font-family: MathJax_Main;">12</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-332" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mn" id="MathJax-Span-334" style="font-family: MathJax_Main;">13</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>5</mn><mrow class="MJX-TeXAtom-ORD"><mn>12</mn></mrow></msup><mo>≡</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mn>13</mn></math></span></span><script type="math/tex" id="MathJax-Element-41">5^{12} \equiv 1 \bmod 13</script></span>.</p>
<p><strong>Fermat's Little Theorem: Proof</strong></p>
<p>Now for the general case. We have to show that if the numbers in the set</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-335" role="math" style="width: 8.377em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.134em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1008.07em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-336"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-339" style="font-family: MathJax_Main; padding-left: 0.306em;">{</span><span class="mn" id="MathJax-Span-340" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main; padding-left: 0.185em;">…</span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main; padding-left: 0.185em;">,</span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-346" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo>=</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-42">
  S = \{ 1, \ldots, p-1 \}
</script></span></p>
<p>get multiplied by <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-348" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-349"><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">a</script></span> modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-351" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">p</script></span>, the resulting numbers are distinct and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-354" role="math" style="width: 1.702em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.641em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1001.58em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-355"><span class="mo" id="MathJax-Span-356" style="font-family: MathJax_Main;">≠</span><span class="mn" id="MathJax-Span-357" style="font-family: MathJax_Main; padding-left: 0.306em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≠</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-45">\neq 0</script></span>. So let <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-358" role="math" style="width: 4.251em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.129em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1004.13em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main; padding-left: 0.306em;">≠</span><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">j</span><span class="mo" id="MathJax-Span-363" style="font-family: MathJax_Main; padding-left: 0.306em;">∈</span><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≠</mo><mi>j</mi><mo>∈</mo><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">i \neq j \in S</script></span>, and consider <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-365" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.85em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-366"><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">ai</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-369" role="math" style="width: 1.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.97em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">aj</script></span>. Suppose <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-373" role="math" style="width: 7.527em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.285em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1007.16em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-italic;">j</span><span class="TeXmathchoice" id="MathJax-Span-380"><span class="mspace" id="MathJax-Span-381" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-382" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-383" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-384" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-386" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>i</mi><mo>≡</mo><mi>a</mi><mi>j</mi><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>p</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">ai \equiv aj \pmod p</script></span>. Then <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-387" role="math" style="width: 6.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1006.13em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-388"><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-390" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">j</span><span class="TeXmathchoice" id="MathJax-Span-392"><span class="mspace" id="MathJax-Span-393" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-396" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≡</mo><mi>j</mi><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>p</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-50">i \equiv j \pmod p</script></span> and contradiction with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-399" role="math" style="width: 2.248em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.187em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.19em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main; padding-left: 0.306em;">≠</span><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≠</mo><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">i \neq j</script></span>. So <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-404" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.85em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-405"><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">ai</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-408" role="math" style="width: 1.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.97em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-409"><span class="mi" id="MathJax-Span-410" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">aj</script></span> are distinct modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-412" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-413"><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">p</script></span>. If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-415" role="math" style="width: 2.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.794em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.73em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-416"><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-419" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-420" style="font-family: MathJax_Main; padding-left: 0.306em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>i</mi><mo>≡</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-55">ai \equiv 0</script></span> then, since <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-421" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-422"><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">a</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-424" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-425"><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">p</script></span> are relatively prime, we can divide by <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-427" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">a</script></span> and get <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-430" role="math" style="width: 2.309em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.248em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.19em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-433" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-434" style="font-family: MathJax_Main; padding-left: 0.306em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≡</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-59">i \equiv 0</script></span>, and contradiction. So the resulting numbers are <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-435" role="math" style="width: 1.702em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.641em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1001.58em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-436"><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main;">≠</span><span class="mn" id="MathJax-Span-438" style="font-family: MathJax_Main; padding-left: 0.306em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≠</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-60">\neq 0</script></span>. This means the result of multiplying the numbers in <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-439" role="math" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.035em 1000.73em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">S</script></span> with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-442" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-443"><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">a</script></span> modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-445" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-446"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">p</script></span> is a permutation of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-448" role="math" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.035em 1000.73em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-64">S</script></span>.</p>
<p>This gives</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-451" role="math" style="width: 26.217em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.428em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1025.37em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-452"><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main; padding-left: 0.306em;">{</span><span class="mn" id="MathJax-Span-456" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main; padding-left: 0.185em;">…</span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main; padding-left: 0.185em;">,</span><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-462" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-463" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-464" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-465" style="font-family: MathJax_Main; padding-left: 0.306em;">{</span><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mn" id="MathJax-Span-468" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-469" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="texatom" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main; padding-left: 0.185em;">…</span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main; padding-left: 0.185em;">,</span><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">a</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math-italic; padding-left: 0.246em;">p</span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-480" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="texatom" id="MathJax-Span-482"><span class="mrow" id="MathJax-Span-483"><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math-italic;">p</span></span></span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mo>=</mo><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo><mo>=</mo><mo fence="false" stretchy="false">{</mo><mi>a</mi><mo>×</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mrow class="MJX-TeXAtom-ORD"><mi>p</mi></mrow><mo>,</mo><mo>…</mo><mo>,</mo><mi>a</mi><mo>×</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mrow class="MJX-TeXAtom-ORD"><mi>p</mi></mrow><mo fence="false" stretchy="false">}</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-65">
  S = \{ 1, \ldots, p-1 \} = \{ a \times 1 \bmod{p},  \ldots, a \times p-1 \bmod{p} \}.
</script></span></p>
<p>Multiplying the numbers left and right gives:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-487" role="math" style="width: 16.569em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.083em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1016.02em 2.612em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-488"><span class="mo" id="MathJax-Span-489" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-491" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-492" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-493" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main;">!</span><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-496" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-498"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mo" id="MathJax-Span-504" style="font-family: MathJax_Main; padding-left: 0.246em;">(</span><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-506" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-507" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-509" style="font-family: MathJax_Main;">!</span><span class="TeXmathchoice" id="MathJax-Span-510"><span class="mspace" id="MathJax-Span-511" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-513" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-514" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-516" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-517" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo><mo>=</mo><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>×</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>p</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-66">
  (p-1)! = a^{p-1} \times (p-1)! \pmod{p}. 
</script></span></p>
<p>We can divide both sides by <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-518" role="math" style="width: 3.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.34em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1003.28em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-519"><span class="mo" id="MathJax-Span-520" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-523" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-524" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-525" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo></math></span></span><script type="math/tex" id="MathJax-Element-67">(p-1)!</script></span> because <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-526" role="math" style="width: 3.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.34em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1003.28em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-527"><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-530" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-531" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-533" style="font-family: MathJax_Main;">!</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo></math></span></span><script type="math/tex" id="MathJax-Element-68">(p-1)!</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-534" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-535"><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-69">p</script></span> are relatively prime. This gives <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-537" role="math" style="width: 8.134em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.891em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1007.77em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-538"><span class="msubsup" id="MathJax-Span-539"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-541"><span class="mrow" id="MathJax-Span-542"><span class="mi" id="MathJax-Span-543" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-544" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-547" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="TeXmathchoice" id="MathJax-Span-548"><span class="mspace" id="MathJax-Span-549" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-550" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-552" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-554" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><mn>1</mn><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>p</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-70">a^{p-1} \equiv 1 \pmod{p}</script></span>. QED</p>
<p><strong>Fermat's Algorithm for Primality Testing</strong></p>
<ul>
<li>Pick <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-555" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-556"><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">a</script></span> with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-558" role="math" style="width: 4.857em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.675em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1004.68em 2.37em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-559"><span class="mn" id="MathJax-Span-560" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>&lt;</mo><mi>a</mi><mo>&lt;</mo><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-72">1 < a < N</script></span> at random.</li>
<li>Compute <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-565" role="math" style="width: 6.86em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.617em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1006.5em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-566"><span class="msubsup" id="MathJax-Span-567"><span style="display: inline-block; position: relative; width: 2.127em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-568" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-569"><span class="mrow" id="MathJax-Span-570"><span class="mi" id="MathJax-Span-571" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-572" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-574"><span class="mspace" id="MathJax-Span-575" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-576" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-578" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-73">a^{N-1} \pmod N</script></span> using fast exponentiation.</li>
<li>If the outcome is <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-581" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1000.49em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-582"><span class="mn" id="MathJax-Span-583" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-74">1</script></span>,
<ul>
<li>output "Probably Prime",</li>
<li>otherwise output "Composite".</li>
</ul></li>
</ul>
<p>If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-584" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-585"><span class="mi" id="MathJax-Span-586" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">N</script></span> is indeed prime then <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-587" role="math" style="width: 8.741em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.498em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1008.38em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-588"><span class="msubsup" id="MathJax-Span-589"><span style="display: inline-block; position: relative; width: 2.127em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-590" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-591"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-597" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="TeXmathchoice" id="MathJax-Span-598"><span class="mspace" id="MathJax-Span-599" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-602" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><mn>1</mn><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-76">a^{N-1} \equiv 1 \pmod N</script></span>, and the test works fine.</p>
<p>But if <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-605" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-606"><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">N</script></span> is composite, it may still happen that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-608" role="math" style="width: 8.741em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.498em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1008.38em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-609"><span class="msubsup" id="MathJax-Span-610"><span style="display: inline-block; position: relative; width: 2.127em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-612"><span class="mrow" id="MathJax-Span-613"><span class="mi" id="MathJax-Span-614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-615" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-616" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-618" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="TeXmathchoice" id="MathJax-Span-619"><span class="mspace" id="MathJax-Span-620" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-621" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-622" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-623" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-624" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-625" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><mn>1</mn><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-78">a^{N-1} \equiv 1 \pmod N</script></span>, for Fermat's Little Theorem does not specify what happens for composite numbers ...</p>
<p><strong>Implementation</strong></p>
<p>Fermat's algorithm yields the following primality test:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; prime_test_F ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span>
<span class="ot">&gt;</span> prime_test_F n <span class="fu">=</span> <span class="kw">do</span> 
<span class="ot">&gt;</span>    a <span class="ot">&lt;-</span> randomRIO (<span class="dv">1</span>, n<span class="fu">-</span><span class="dv">1</span>)<span class="ot"> ::</span> <span class="dt">IO</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span>    return (exM a (n<span class="fu">-</span><span class="dv">1</span>) n <span class="fu">==</span> <span class="dv">1</span>)</code></pre></div>
<p><strong>Improving the Fermat Algorithm</strong></p>
<p>A better prime test results if we try out more candidates for <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-626" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-627"><span class="mi" id="MathJax-Span-628" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-79">a</script></span>:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; prime_tests_F ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span>
<span class="ot">&gt;</span> prime_tests_F k n <span class="fu">=</span> <span class="kw">do</span>
<span class="ot">&gt;</span>  as <span class="ot">&lt;-</span> sequence <span class="fu">$</span> fmap (\_<span class="ot">-&gt;</span> randomRIO (<span class="dv">1</span>,n<span class="fu">-</span><span class="dv">1</span>)) [<span class="dv">1</span><span class="fu">..</span>k]
<span class="ot">&gt;</span>  return (all (\ a <span class="ot">-&gt;</span> exM a (n<span class="fu">-</span><span class="dv">1</span>) n <span class="fu">==</span> <span class="dv">1</span>) as)</code></pre></div>
<p>There remains a possibility of getting false positives </p>
<p>One of your tasks for this week will be to test this function.</p>
<p><strong>An Addition to the Fermat Test: Miller and Rabin</strong></p>
<div class="figure">
<img src="./Lecture6_files/GaryMiller.jpg" alt="Gary Miller">
<p class="caption">Gary Miller</p>
</div>
<div class="figure">
<img src="./Lecture6_files/rabin.jpg" alt="Michael Rabin">
<p class="caption">Michael Rabin</p>
</div>
<p>Unfortunately, there are numbers that can fool the Fermat test, so called <em>Carmichael numbers</em>. You will encounter Carmichael numbers in the lab exercises.</p>
<p>Miller and Rabin <span class="citation">(Miller 1976,<span class="citation">Rabin (1980)</span>)</span> propose to add a further test, called the <a href="https://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test">Miller-Rabin primality test</a>.</p>
<p><strong>Basis of the Miller and Rabin Test</strong></p>
<p><strong>Lemma</strong>: If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-629" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-630"><span class="mi" id="MathJax-Span-631" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">n</script></span> is a prime, then any number <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-632" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-633"><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">x</script></span> with the property that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-635" role="math" style="width: 6.192em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.01em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1006.01em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-636"><span class="msubsup" id="MathJax-Span-637"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mn" id="MathJax-Span-639" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">x^2 =  1 \bmod n</script></span> has to satisfy <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-644" role="math" style="width: 5.768em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.586em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1005.59em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-645"><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-647" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-648" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="mo" id="MathJax-Span-649" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-650" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-83">x = 1 \bmod n</script></span> or <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-651" role="math" style="width: 6.556em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.374em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1006.37em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-652"><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-654" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-655" style="font-family: MathJax_Main; padding-left: 0.306em;">−</span><span class="mn" id="MathJax-Span-656" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo>−</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">x = -1 \bmod  n</script></span>.</p>
<p><strong>Proof of Lemma</strong>:</p>
<p>To see why this has to hold, notice that from <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-659" role="math" style="width: 6.192em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.01em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1006.01em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-660"><span class="msubsup" id="MathJax-Span-661"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-662" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mn" id="MathJax-Span-663" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-665" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="mo" id="MathJax-Span-666" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-667" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">x^2 = 1 \bmod n</script></span> it follows that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-668" role="math" style="width: 15.84em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.355em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1015.36em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-669"><span class="msubsup" id="MathJax-Span-670"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-671" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mn" id="MathJax-Span-672" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-673" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-674" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-676" style="font-family: MathJax_Main; padding-left: 0.306em;">(</span><span class="mi" id="MathJax-Span-677" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-678" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-679" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-680" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-681" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-682" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-683" style="font-family: MathJax_Main; padding-left: 0.246em;">+</span><span class="mn" id="MathJax-Span-684" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-685" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-686" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-687" style="font-family: MathJax_Main; padding-left: 0.306em;">0</span><span class="mo" id="MathJax-Span-688" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-689" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">x^2 - 1 = (x-1)(x+1) = 0 \bmod n</script></span>. This means that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-690" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-691"><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">n</script></span> divides <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-693" role="math" style="width: 6.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.253em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1006.13em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-694"><span class="mo" id="MathJax-Span-695" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-696" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-697" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-698" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-699" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-700" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-701" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-702" style="font-family: MathJax_Main; padding-left: 0.246em;">+</span><span class="mn" id="MathJax-Span-703" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-704" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-88">(x-1)(x+1)</script></span>. Since <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-705" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-706"><span class="mi" id="MathJax-Span-707" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">n</script></span> is prime, it follows from this (by a lemma called <a href="https://en.wikipedia.org/wiki/Euclid&#39;s_lemma">Euclid's Lemma</a>) that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-708" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-709"><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">n</script></span> has to divide either <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-711" role="math" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.31em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-712"><span class="mi" id="MathJax-Span-713" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-715" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-91">x-1</script></span> or <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-716" role="math" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.31em 2.37em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-717"><span class="mi" id="MathJax-Span-718" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-719" style="font-family: MathJax_Main; padding-left: 0.246em;">+</span><span class="mn" id="MathJax-Span-720" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-92">x+1</script></span>. In the former case we have <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-721" role="math" style="width: 7.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.345em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1007.35em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-722"><span class="mi" id="MathJax-Span-723" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-724" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-725" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-726" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-727" style="font-family: MathJax_Main; padding-left: 0.306em;">0</span><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-729" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>−</mo><mn>1</mn><mo>=</mo><mn>0</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-93">x-1 = 0 \bmod n</script></span>, i.e., <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-730" role="math" style="width: 5.768em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.586em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1005.59em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-731"><span class="mi" id="MathJax-Span-732" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-733" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-734" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-736" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">x = 1 \bmod n</script></span>. Int the latter case we have <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-737" role="math" style="width: 6.556em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.374em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1006.37em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-738"><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-741" style="font-family: MathJax_Main; padding-left: 0.306em;">−</span><span class="mn" id="MathJax-Span-742" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-743" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo>−</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-95">x = -1 \bmod n</script></span>. QED</p>
<p>Note that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-745" role="math" style="width: 8.377em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.134em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1008.13em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-746"><span class="mo" id="MathJax-Span-747" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-748" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-749" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-750" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">n</span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-752" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-753" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mn>1</mn><mo>=</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-96">-1 = n-1 \bmod n</script></span>.</p>
<p><strong>Euclid's Lemma</strong>: If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-755" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-756"><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-97">p</script></span> is prime and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-758" role="math" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.37em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-759"><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main; padding-left: 0.306em;">∣</span><span class="mi" id="MathJax-Span-762" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-763" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>∣</mo><mi>a</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-98">p \mid ab</script></span> then either <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-764" role="math" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.945em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1001.95em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-765"><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-767" style="font-family: MathJax_Main; padding-left: 0.306em;">∣</span><span class="mi" id="MathJax-Span-768" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>∣</mo><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-99">p \mid a</script></span> or <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-769" role="math" style="width: 1.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1001.82em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-770"><span class="mi" id="MathJax-Span-771" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-772" style="font-family: MathJax_Main; padding-left: 0.306em;">∣</span><span class="mi" id="MathJax-Span-773" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>∣</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-100">p \mid b</script></span>.</p>
<p><strong>Proof of Euclid's Lemma</strong>:</p>
<p>Observe that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-REL&quot;&gt;&lt;mpadded width=&quot;0&quot;&gt;&lt;mtext&gt;&amp;#x29F8;&lt;/mtext&gt;&lt;/mpadded&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-774" role="math" style="width: 2.187em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.127em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.13em 2.612em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-775"><span class="mi" id="MathJax-Span-776" style="font-family: MathJax_Math-italic;">p</span><span class="texatom" id="MathJax-Span-777" style="padding-left: 0.306em;"><span class="mrow" id="MathJax-Span-778"><span class="mpadded" id="MathJax-Span-779"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.67em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mrow" id="MathJax-Span-780"><span class="mtext" id="MathJax-Span-781" style="font-family: MathJax_Math-italic;">/</span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-782" style="height: 0.003em; vertical-align: 0.003em; width: 0.185em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-783" style="font-family: MathJax_Main;">∣</span><span class="mi" id="MathJax-Span-784" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mrow class="MJX-TeXAtom-REL"><mpadded width="0"><mtext>⧸</mtext></mpadded></mrow><mspace width="thinmathspace"></mspace><mo>∣</mo><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">p \not\,\mid a</script></span> implies that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-785" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-786"><span class="mi" id="MathJax-Span-787" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">p</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-788" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-789"><span class="mi" id="MathJax-Span-790" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">a</script></span> are co-prime.</p>
<p>So suppose <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-791" role="math" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.37em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-792"><span class="mi" id="MathJax-Span-793" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-794" style="font-family: MathJax_Main; padding-left: 0.306em;">∣</span><span class="mi" id="MathJax-Span-795" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>∣</mo><mi>a</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-104">p \mid ab</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-REL&quot;&gt;&lt;mpadded width=&quot;0&quot;&gt;&lt;mtext&gt;&amp;#x29F8;&lt;/mtext&gt;&lt;/mpadded&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-797" role="math" style="width: 2.187em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.127em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.13em 2.612em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-798"><span class="mi" id="MathJax-Span-799" style="font-family: MathJax_Math-italic;">p</span><span class="texatom" id="MathJax-Span-800" style="padding-left: 0.306em;"><span class="mrow" id="MathJax-Span-801"><span class="mpadded" id="MathJax-Span-802"><span style="display: inline-block; position: relative; width: 0.003em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.67em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mrow" id="MathJax-Span-803"><span class="mtext" id="MathJax-Span-804" style="font-family: MathJax_Math-italic;">/</span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-805" style="height: 0.003em; vertical-align: 0.003em; width: 0.185em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">∣</span><span class="mi" id="MathJax-Span-807" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mrow class="MJX-TeXAtom-REL"><mpadded width="0"><mtext>⧸</mtext></mpadded></mrow><mspace width="thinmathspace"></mspace><mo>∣</mo><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">p \not\,\mid a</script></span>. Then, by Euclid's extended GCD algorithm, there are <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-808" role="math" style="width: 3.644em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.522em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.641em 1003.46em 2.855em -999.997em); top: -2.485em; left: 0.003em;"><span class="mrow" id="MathJax-Span-809"><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-811" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-812" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-813" style="font-family: MathJax_Main; padding-left: 0.306em;">∈</span><span class="texatom" id="MathJax-Span-814" style="padding-left: 0.306em;"><span class="mrow" id="MathJax-Span-815"><span class="texatom" id="MathJax-Span-816"><span class="mrow" id="MathJax-Span-817"><span class="mi" id="MathJax-Span-818" style="font-family: MathJax_AMS;">Z</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.491em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi><mo>∈</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">Z</mi></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-106">x,y \in {\mathbb Z}</script></span> with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;gcd&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-819" role="math" style="width: 10.743em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.44em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1010.38em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-820"><span class="mi" id="MathJax-Span-821" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-823" style="font-family: MathJax_Main; padding-left: 0.246em;">+</span><span class="mi" id="MathJax-Span-824" style="font-family: MathJax_Math-italic; padding-left: 0.246em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-826" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-827" style="font-family: MathJax_Main; padding-left: 0.306em;">gcd</span><span class="mo" id="MathJax-Span-828" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-829" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-830" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-831" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">p</span><span class="mo" id="MathJax-Span-832" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-833" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-834" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mi>a</mi><mo>+</mo><mi>y</mi><mi>p</mi><mo>=</mo><mo movablelimits="true" form="prefix">gcd</mo><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-107">xa + yp = \gcd(a,p) = 1</script></span>. Multiplying both sides by <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-835" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.49em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-836"><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">b</script></span> gives <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-838" role="math" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.071em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1006.07em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-839"><span class="mi" id="MathJax-Span-840" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-841" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-843" style="font-family: MathJax_Main; padding-left: 0.246em;">+</span><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math-italic; padding-left: 0.246em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Math-italic;">p</span><span class="mi" id="MathJax-Span-846" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-847" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mi>a</mi><mi>b</mi><mo>+</mo><mi>y</mi><mi>p</mi><mi>b</mi><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-109">xab + ypb = b</script></span>. Since it is given that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-849" role="math" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.37em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-850"><span class="mi" id="MathJax-Span-851" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-852" style="font-family: MathJax_Main; padding-left: 0.306em;">∣</span><span class="mi" id="MathJax-Span-853" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">a</span><span class="mi" id="MathJax-Span-854" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>∣</mo><mi>a</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-110">p \mid ab</script></span> we get that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-855" role="math" style="width: 1.884em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1001.82em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-856"><span class="mi" id="MathJax-Span-857" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-858" style="font-family: MathJax_Main; padding-left: 0.306em;">∣</span><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>∣</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-111">p \mid b</script></span>. QED</p>
<p><strong>Factoring out powers of 2</strong></p>
<p>The following function factors out powers of 2:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; decomp ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> (<span class="dt">Integer</span>,<span class="dt">Integer</span>)
<span class="ot">&gt;</span> decomp n <span class="fu">=</span> decomp' (<span class="dv">0</span>,n) <span class="kw">where</span>
<span class="ot">&gt;</span>   decomp' <span class="fu">=</span> until (odd<span class="fu">.</span>snd) (\ (m,n) <span class="ot">-&gt;</span> (m<span class="fu">+</span><span class="dv">1</span>,div n <span class="dv">2</span>))</code></pre></div>
<p>This gives:</p>
<pre><code>*Lecture6&gt; decomp 53248
(12,13)
*Lecture6&gt; 2^12 * 13
53248</code></pre>
<p><strong>The Miller-Rabin Primality Test</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; primeMR ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span>
<span class="ot">&gt;</span> primeMR _ <span class="dv">2</span> <span class="fu">=</span> return <span class="dt">True</span>
<span class="ot">&gt;</span> primeMR <span class="dv">0</span> _ <span class="fu">=</span> return <span class="dt">True</span>
<span class="ot">&gt;</span> primeMR k n <span class="fu">=</span> <span class="kw">let</span> 
<span class="ot">&gt;</span>    (r,s) <span class="fu">=</span> decomp (n<span class="fu">-</span><span class="dv">1</span>) 
<span class="ot">&gt;</span>    f <span class="fu">=</span> \ x <span class="ot">-&gt;</span> takeWhile (<span class="fu">/=</span> <span class="dv">1</span>) 
<span class="ot">&gt;</span>        (map (\ j <span class="ot">-&gt;</span> exM x (<span class="dv">2</span><span class="fu">^</span>j<span class="fu">*</span>s) n)  [<span class="dv">0</span><span class="fu">..</span>r])
<span class="ot">&gt;</span>   <span class="kw">in</span> 
<span class="ot">&gt;</span>    <span class="kw">do</span> 
<span class="ot">&gt;</span>     a <span class="ot">&lt;-</span> randomRIO (<span class="dv">1</span>, n<span class="fu">-</span><span class="dv">1</span>)<span class="ot"> ::</span> <span class="dt">IO</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span>     <span class="kw">if</span> exM a (n<span class="fu">-</span><span class="dv">1</span>) n <span class="fu">/=</span> <span class="dv">1</span> 
<span class="ot">&gt;</span>       <span class="kw">then</span> return <span class="dt">False</span> 
<span class="ot">&gt;</span>       <span class="kw">else</span> 
<span class="ot">&gt;</span>         <span class="kw">if</span> exM a s n <span class="fu">/=</span> <span class="dv">1</span> <span class="fu">&amp;&amp;</span> last (f a) <span class="fu">/=</span> (n<span class="fu">-</span><span class="dv">1</span>) 
<span class="ot">&gt;</span>           <span class="kw">then</span> return <span class="dt">False</span>
<span class="ot">&gt;</span>           <span class="kw">else</span> primeMR (k<span class="fu">-</span><span class="dv">1</span>) n</code></pre></div>
<p><strong>Testing the Primality Tests</strong></p>
<p>For testing our primality test algorithms the list of prime numbers generated by Eratosthenes' sieve is useless, for the algorithms all correctly classify the primes as primes. Where they can go wrong is on classifying composite numbers; these can slip through the Fermat test, and also through the Rabin/Miller test, although the probability of this can be made arbitrarily small.</p>
<p>One of your exercises for this week will be to write a function for generating the composite numbers, for testing purposes.</p>
<p><strong>Application to Cryptography</strong></p>
<p>The idea to base public key cryptography on the fact that finding large primes, multiplying them, and exponentiation modulo a prime are easy while factoring numbers that are multiples of large primes, and finding <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-860" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-861"><span class="mi" id="MathJax-Span-862" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-112">x</script></span> from <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-863" role="math" style="width: 4.19em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.069em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1004.07em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-864"><span class="msubsup" id="MathJax-Span-865"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-866" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-867" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-868" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-869" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>a</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-113">x^a \bmod p</script></span> (taking the discrete logarithm) are hard was put forward by Diffie and Hellman in <span class="citation">(Diffie and Hellman 1976)</span>.</p>
<div class="figure">
<img src="./Lecture6_files/Diffie_and_Hellman.jpg" alt="Whitfield Diffie and Martin Hellman">
<p class="caption">Whitfield Diffie and Martin Hellman</p>
</div>
<p><strong>Diffie-Hellman Key Exchange Protocol</strong></p>
<ul>
<li><p>Alice and Bob agree on a large prime <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-870" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-871"><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-114">p</script></span> and a base <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-873" role="math" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.399em 1002.37em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-874"><span class="mi" id="MathJax-Span-875" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-876" style="font-family: MathJax_Main; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-877" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo>&lt;</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">g < p</script></span> such that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-878" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.49em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-879"><span class="mi" id="MathJax-Span-880" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">g</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-881" role="math" style="width: 2.37em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.309em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1002.25em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-882"><span class="mi" id="MathJax-Span-883" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-884" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-885" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-117">p-1</script></span> are co-prime.</p></li>
<li><p>Alice picks a secret <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-886" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-887"><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">a</script></span> and sends <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-889" role="math" style="width: 6.314em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.132em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1006.13em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-890"><span class="msubsup" id="MathJax-Span-891"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-892" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-893" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-894" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-895" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-896" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-897" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">A</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mi>a</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>=</mo><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">g^a \bmod p= A</script></span> to Bob.</p></li>
<li><p>Bob picks a secret <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-898" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.49em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-899"><span class="mi" id="MathJax-Span-900" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">b</script></span> and sends <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-901" role="math" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.071em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1006.07em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-902"><span class="msubsup" id="MathJax-Span-903"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-905" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-906" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-908" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-909" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">B</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mi>b</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>=</mo><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">g^b \bmod p = B</script></span> to Alice.</p></li>
<li><p>Alice calculates <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-910" role="math" style="width: 6.314em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.132em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1006.13em 2.552em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-911"><span class="mi" id="MathJax-Span-912" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-913" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-914" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.217em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.73em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-915" style="font-family: MathJax_Math-italic;">B</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.792em;"><span class="mi" id="MathJax-Span-916" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-917" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-918" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><msup><mi>B</mi><mi>a</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-122">k = B^a \bmod p</script></span>.</p></li>
<li><p>Bob calculates <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-919" role="math" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.071em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.156em 1006.07em 2.552em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-920"><span class="mi" id="MathJax-Span-921" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-922" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-923" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.156em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.73em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-924" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.731em;"><span class="mi" id="MathJax-Span-925" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-926" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><msup><mi>A</mi><mi>b</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-123">k = A^b \bmod p</script></span>.</p></li>
<li><p>They now have a shared key <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-928" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-929"><span class="mi" id="MathJax-Span-930" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-124">k</script></span>. This is because <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-931" role="math" style="width: 10.986em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.622em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1010.62em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-932"><span class="mi" id="MathJax-Span-933" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-934" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-935" style="font-family: MathJax_Main; padding-left: 0.306em;">(</span><span class="msubsup" id="MathJax-Span-936"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-937" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-938" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-939"><span style="display: inline-block; position: relative; width: 0.792em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.31em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mo" id="MathJax-Span-940" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.367em;"><span class="mi" id="MathJax-Span-941" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-942" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-943" style="font-family: MathJax_Main; padding-left: 0.306em;">(</span><span class="msubsup" id="MathJax-Span-944"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-945" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-946" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-947"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.31em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mo" id="MathJax-Span-948" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.367em;"><span class="mi" id="MathJax-Span-949" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-950" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>a</mi></msup><msup><mo stretchy="false">)</mo><mi>b</mi></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>b</mi></msup><msup><mo stretchy="false">)</mo><mi>a</mi></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">k = (g^a)^b = (g^b)^a \bmod p</script></span>.</p></li>
</ul>
<p><strong>Use of a Shared Secret Key for Secure Communication</strong></p>
<p>Let <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-952" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-953"><span class="mi" id="MathJax-Span-954" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-126">p</script></span> be the prime that Alice and Bob have agreed on, and let <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-955" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-956"><span class="mi" id="MathJax-Span-957" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-127">k</script></span> be their shared key. Then message <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-958" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-959"><span class="mi" id="MathJax-Span-960" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-128">m</script></span> is encoded as</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-961" role="math" style="width: 6.132em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.95em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1005.89em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-962"><span class="mi" id="MathJax-Span-963" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mi" id="MathJax-Span-965" style="font-family: MathJax_Math-italic; padding-left: 0.246em;">k</span><span class="mo" id="MathJax-Span-966" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-967" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>m</mi><mo>×</mo><mi>k</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-129">m \times k \bmod p.</script></span></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; encodeDH ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> encodeDH p k m <span class="fu">=</span> m<span class="fu">*</span>k <span class="ot">`mod`</span> p</code></pre></div>
<p>Such messages can be decoded by both Alice and Bob.</p>
<p>Alice knows <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-969" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-970"><span class="mi" id="MathJax-Span-971" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-130">p</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-972" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-973"><span class="mi" id="MathJax-Span-974" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">k</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-975" role="math" style="width: 1.035em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(-0.058em 1000.97em 1.338em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-976"><span class="msubsup" id="MathJax-Span-977"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-979" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mi>b</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-132">g^b</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-980" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-981"><span class="mi" id="MathJax-Span-982" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-133">a</script></span>. She decodes cipher <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-983" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.49em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-984"><span class="mi" id="MathJax-Span-985" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-134">c</script></span> with</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-986" role="math" style="width: 9.833em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.53em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.974em 1009.47em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-987"><span class="mi" id="MathJax-Span-988" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-989" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mo" id="MathJax-Span-990" style="font-family: MathJax_Main; padding-left: 0.246em;">(</span><span class="msubsup" id="MathJax-Span-991"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-992" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="mi" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-994"><span style="display: inline-block; position: relative; width: 3.219em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.31em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mo" id="MathJax-Span-995" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.367em;"><span class="texatom" id="MathJax-Span-996"><span class="mrow" id="MathJax-Span-997"><span class="mo" id="MathJax-Span-998" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-999" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1000" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1001" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1002" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1003" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1004" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-1006" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1007" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mo>×</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>b</mi></msup><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>a</mi></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-135">
    c \times (g^b)^{(p-1)-a} \bmod p.
</script></span></p>
<p>Bob knows <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1008" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1009"><span class="mi" id="MathJax-Span-1010" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-136">p</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1011" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1012"><span class="mi" id="MathJax-Span-1013" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-137">k</script></span>, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1014" role="math" style="width: 1.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.124em 1001.04em 1.338em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1015"><span class="msubsup" id="MathJax-Span-1016"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1017" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-1018" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mi>a</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-138">g^a</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1019" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.49em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1020"><span class="mi" id="MathJax-Span-1021" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">b</script></span>. He decodes cipher <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1022" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.49em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1023"><span class="mi" id="MathJax-Span-1024" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-140">c</script></span> with</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1025" role="math" style="width: 9.833em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.53em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.974em 1009.47em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1026"><span class="mi" id="MathJax-Span-1027" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1028" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mo" id="MathJax-Span-1029" style="font-family: MathJax_Main; padding-left: 0.246em;">(</span><span class="msubsup" id="MathJax-Span-1030"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1031" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="mi" id="MathJax-Span-1032" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1033"><span style="display: inline-block; position: relative; width: 3.158em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.31em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mo" id="MathJax-Span-1034" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.367em;"><span class="texatom" id="MathJax-Span-1035"><span class="mrow" id="MathJax-Span-1036"><span class="mo" id="MathJax-Span-1037" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1038" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1039" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1040" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1041" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1042" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1043" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1044" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-1045" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1046" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mo>×</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>a</mi></msup><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-141">
   c \times (g^a)^{(p-1)-b} \bmod p.
</script></span></p>
<p><strong>What is behind this is again Fermat's Little Theorem</strong></p>
<p>We have:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1047" role="math" style="width: 25.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.003em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.035em 1025em 2.612em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1048"><span class="mo" id="MathJax-Span-1049" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1050"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1051" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="mi" id="MathJax-Span-1052" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1053"><span style="display: inline-block; position: relative; width: 3.158em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.31em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mo" id="MathJax-Span-1054" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.367em;"><span class="texatom" id="MathJax-Span-1055"><span class="mrow" id="MathJax-Span-1056"><span class="mo" id="MathJax-Span-1057" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1058" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1059" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1061" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1062" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1063" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1064" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-1065" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 4.19em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1066" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1067"><span class="mrow" id="MathJax-Span-1068"><span class="mi" id="MathJax-Span-1069" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1070" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1071" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1072" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1073" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1074" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1075" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1076" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1077" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-1078" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1079" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-1080" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 2.794em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1082"><span class="mrow" id="MathJax-Span-1083"><span class="mi" id="MathJax-Span-1084" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1085" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1086" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1088" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1089" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1090" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="msubsup" id="MathJax-Span-1091" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1092" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1093"><span class="mrow" id="MathJax-Span-1094"><span class="mo" id="MathJax-Span-1095" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1096" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1097" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1098" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-1099" style="font-family: MathJax_Main; padding-left: 0.306em;">(</span><span class="msubsup" id="MathJax-Span-1100"><span style="display: inline-block; position: relative; width: 1.884em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1101" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1102"><span class="mrow" id="MathJax-Span-1103"><span class="mi" id="MathJax-Span-1104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1105" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1106" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1107"><span style="display: inline-block; position: relative; width: 0.853em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.31em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mo" id="MathJax-Span-1108" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.367em;"><span class="mi" id="MathJax-Span-1109" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1110" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="msubsup" id="MathJax-Span-1111" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1112" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1113"><span class="mrow" id="MathJax-Span-1114"><span class="mo" id="MathJax-Span-1115" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1116" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1117" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><msup><mi>g</mi><mi>a</mi></msup><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi></mrow></msup><mo>=</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>×</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>a</mi><mi>b</mi></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>a</mi></msup><mo>×</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>a</mi><mi>b</mi></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-142">
   (g^a)^{(p-1)-b} 
    =  
    g^{a((p-1)-b)} 
    = 
    g^{a(p-1)} \times g^{-ab} 
   =  
   (g^{p-1})^a \times g^{-ab}
</script></span></p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-REL&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1118" role="math" style="width: 13.717em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.292em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.853em 1013.23em 2.552em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1119"><span class="texatom" id="MathJax-Span-1120"><span class="mrow" id="MathJax-Span-1121"><span class="munderover" id="MathJax-Span-1122"><span style="display: inline-block; position: relative; width: 2.43em; height: 0px;"><span style="position: absolute; clip: rect(3.462em 1000.73em 4.069em -999.997em); top: -4.002em; left: 0.853em;"><span class="texatom" id="MathJax-Span-1123"><span class="mrow" id="MathJax-Span-1124"><span class="mo" id="MathJax-Span-1125" style="font-family: MathJax_Main;">=</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; clip: rect(3.219em 1002.43em 4.19em -999.997em); top: -4.548em; left: 0.003em;"><span class="texatom" id="MathJax-Span-1126"><span class="mrow" id="MathJax-Span-1127"><span class="mi" id="MathJax-Span-1128" style="font-size: 70.7%; font-family: MathJax_Math-italic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mi" id="MathJax-Span-1129" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-1130" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-1131" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-1132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-1134" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-1135" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.488em;"><span class="mi" id="MathJax-Span-1136" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1137" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="msubsup" id="MathJax-Span-1138" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1139" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1140"><span class="mrow" id="MathJax-Span-1141"><span class="mo" id="MathJax-Span-1142" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1143" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1144" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1145" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-1146" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1147" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1148"><span class="mrow" id="MathJax-Span-1149"><span class="mo" id="MathJax-Span-1150" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1152" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1153" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-1154" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1155" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-REL"><mover><mrow class="MJX-TeXAtom-OP"><mo>=</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>F</mi><mi>e</mi><mi>r</mi><mi>m</mi><mi>a</mi><mi>t</mi></mrow></mover></mrow><msup><mn>1</mn><mi>a</mi></msup><mo>×</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>a</mi><mi>b</mi></mrow></msup><mo>=</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>a</mi><mi>b</mi></mrow></msup><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-143">
  \stackrel{Fermat}{=} 1^a \times g^{-ab}
  = g^{-ab} \bmod p,
</script></span></p>
<p>and therefore:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1156" role="math" style="width: 30.039em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.129em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.035em 1029.07em 2.612em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1157"><span class="mi" id="MathJax-Span-1158" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1159" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mo" id="MathJax-Span-1160" style="font-family: MathJax_Main; padding-left: 0.246em;">(</span><span class="msubsup" id="MathJax-Span-1161"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1162" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="mi" id="MathJax-Span-1163" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1164"><span style="display: inline-block; position: relative; width: 3.158em; height: 0px;"><span style="position: absolute; clip: rect(3.098em 1000.31em 4.433em -999.997em); top: -4.002em; left: 0.003em;"><span class="mo" id="MathJax-Span-1165" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.367em;"><span class="texatom" id="MathJax-Span-1166"><span class="mrow" id="MathJax-Span-1167"><span class="mo" id="MathJax-Span-1168" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1170" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1171" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1172" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1173" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1174" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1175" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mo" id="MathJax-Span-1176" style="font-family: MathJax_Main; padding-left: 0.306em;">(</span><span class="mi" id="MathJax-Span-1177" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1178" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="msubsup" id="MathJax-Span-1179" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1180" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1181"><span class="mrow" id="MathJax-Span-1182"><span class="mi" id="MathJax-Span-1183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1184" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1185" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1186" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="msubsup" id="MathJax-Span-1187" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1188" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1189"><span class="mrow" id="MathJax-Span-1190"><span class="mo" id="MathJax-Span-1191" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1192" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1193" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1194" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">m</span><span class="mo" id="MathJax-Span-1196" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mo" id="MathJax-Span-1197" style="font-family: MathJax_Main; padding-left: 0.246em;">(</span><span class="msubsup" id="MathJax-Span-1198"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1199" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1200"><span class="mrow" id="MathJax-Span-1201"><span class="mi" id="MathJax-Span-1202" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1204" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="msubsup" id="MathJax-Span-1205" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.372em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-1206" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-1207"><span class="mrow" id="MathJax-Span-1208"><span class="mo" id="MathJax-Span-1209" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-1210" style="font-size: 70.7%; font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1211" style="font-size: 70.7%; font-family: MathJax_Math-italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-1212" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1213" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1214" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">m</span><span class="mo" id="MathJax-Span-1215" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-1216" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1217" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mo>×</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>a</mi></msup><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>b</mi></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><mi>m</mi><mo>×</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>b</mi></mrow></msup><mo stretchy="false">)</mo><mo>×</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>a</mi><mi>b</mi></mrow></msup><mo>=</mo><mi>m</mi><mo>×</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>b</mi></mrow></msup><mo>×</mo><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>a</mi><mi>b</mi></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>p</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-144">
   c \times (g^a)^{(p-1)-b} 
    =  
   (m \times g^{ab}) \times g^{-ab}
   = 
    m \times (g^{ab} \times g^{-ab})
    = m  \bmod p.
</script></span></p>
<p>This gives:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; decodeDH ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> 
<span class="ot">&gt;</span>          <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> decodeDH p k ga b c <span class="fu">=</span> <span class="kw">let</span> 
<span class="ot">&gt;</span>     gab' <span class="fu">=</span> exM ga ((p<span class="fu">-</span><span class="dv">1</span>)<span class="fu">-</span>b) p 
<span class="ot">&gt;</span>   <span class="kw">in</span> 
<span class="ot">&gt;</span>     rem (c<span class="fu">*</span>gab') p</code></pre></div>
<p><strong>Symmetric Key Cyphers</strong></p>
<p>This is called a <em>symmetric key cypher</em>.</p>
<p>Alice and Bob use the same key to encrypt, and a small variation on this key, together with the private information they have, to decrypt.</p>
<p><strong>Symmetric Key Cyphers Using Fast Exponentiation Modulo</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; encode ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> encode p k m <span class="fu">=</span> <span class="kw">let</span> 
<span class="ot">&gt;</span>    p' <span class="fu">=</span> p<span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span>    e  <span class="fu">=</span> head [ x <span class="fu">|</span> x <span class="ot">&lt;-</span> [k<span class="fu">..</span>], gcd x p' <span class="fu">==</span> <span class="dv">1</span> ]
<span class="ot">&gt;</span>  <span class="kw">in</span> 
<span class="ot">&gt;</span>    exM m e p
<span class="ot">&gt;</span> 
<span class="ot">&gt; decode ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> decode p k m <span class="fu">=</span> <span class="kw">let</span> 
<span class="ot">&gt;</span>    p' <span class="fu">=</span> p<span class="fu">-</span><span class="dv">1</span>
<span class="ot">&gt;</span>    e  <span class="fu">=</span> head [ x <span class="fu">|</span> x <span class="ot">&lt;-</span> [k<span class="fu">..</span>], gcd x p' <span class="fu">==</span> <span class="dv">1</span> ]
<span class="ot">&gt;</span>    d  <span class="fu">=</span> invM e p' 
<span class="ot">&gt;</span>  <span class="kw">in</span> 
<span class="ot">&gt;</span>    exM m d p</code></pre></div>
<p><strong>Efficient With Key, Hard Without</strong></p>
<p>Finding appropriate <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1218" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.43em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1219"><span class="mi" id="MathJax-Span-1220" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">e</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1221" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1222"><span class="mi" id="MathJax-Span-1223" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-146">d</script></span> for coding and decoding when <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1224" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1225"><span class="mi" id="MathJax-Span-1226" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">p</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1227" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1228"><span class="mi" id="MathJax-Span-1229" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">k</script></span> are known is fast.</p>
<p>Suppose one were allowed to keep the modulus <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1230" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1231"><span class="mi" id="MathJax-Span-1232" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-149">p</script></span> and the lower bound for the exponent <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1233" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1234"><span class="mi" id="MathJax-Span-1235" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-150">k</script></span> hidden in the above coding function. Then <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1236" role="math" style="width: 1.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1001.52em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1237"><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1239" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1240" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>,</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-151">p,k</script></span> is the key to both coding and decoding.</p>
<p>If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1241" role="math" style="width: 1.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1001.52em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1242"><span class="mi" id="MathJax-Span-1243" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1244" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1245" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>,</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-152">p,k</script></span> are both known, coding and decoding are both easy (see above). If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1246" role="math" style="width: 1.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1001.52em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1247"><span class="mi" id="MathJax-Span-1248" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1249" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1250" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>,</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-153">p,k</script></span> are unknown, both coding and decoding are hard.</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; cipher ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> cipher <span class="fu">=</span> encode secret bound
<span class="ot">&gt;</span> 
<span class="ot">&gt; decipher ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> decipher <span class="fu">=</span> decode secret bound</code></pre></div>
<p><strong>Look at this</strong></p>
<pre><code> *Lecture6&gt; cipher 123
 59919695618995421503916756397503286001898487947920162937
 23993242822009438133642886682530069654361563275429068325
 99325957585106515246102899061628169372657254294820399394
 78144012585334805003984324282240871591536702957793570769
 96956357790457581539952685957650593709298723348227
 
 *Lecture6&gt; decipher 599196956189954215039167563975032860018
 98487947920162937239932428220094381336428866825300696543
 61563275429068325993259575851065152461028990616281693726
 57254294820399394781440125853348050039843242822408715915
 36702957793570769969563577904575815399526859576505937092
 98723348227
 123</code></pre>
<p><strong>A Problem</strong></p>
<p>There is a problem, however. In order to construct the function <code>cipher</code>, the secret prime and the bound for the exponent have to be available, so we cannot make the full recipe for constructing the encoding function publicly available.</p>
<p>This can be solved by a variation on the Diffie-Hellman key exchange protocol.</p>
<p>In <em>asymmetric</em> public key cryptography, it turns out we can do much better than this. We can generate a key and make it publicly available, and from that key anyone can construct an encoding function. Decoding, given only this public key information, is generally thought to be hard.</p>
<p><strong>RSA = Rivest, Shamir, Adleman</strong></p>
<div class="figure">
<img src="./Lecture6_files/Len-Adi-Ron.jpg" alt="Len Adleman -- Adi Shamir -- Ron Rivest">
<p class="caption">Len Adleman -- Adi Shamir -- Ron Rivest</p>
</div>
<p><strong>RSA public key cryptography; generation of a public key</strong></p>
<p>See <span class="citation">(R. Rivest, Shamir, and Adleman 1978)</span>.</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; rsa_public ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> (<span class="dt">Integer</span>,<span class="dt">Integer</span>)
<span class="ot">&gt;</span> rsa_public p q <span class="fu">=</span> <span class="kw">let</span> 
<span class="ot">&gt;</span>    n   <span class="fu">=</span> p <span class="fu">*</span> q
<span class="ot">&gt;</span>    phi <span class="fu">=</span> (p<span class="fu">-</span><span class="dv">1</span>)<span class="fu">*</span>(q<span class="fu">-</span><span class="dv">1</span>)
<span class="ot">&gt;</span>    e   <span class="fu">=</span> head [ x <span class="fu">|</span> x <span class="ot">&lt;-</span> [<span class="dv">3</span><span class="fu">..</span>], gcd x phi <span class="fu">==</span> <span class="dv">1</span> ]
<span class="ot">&gt;</span>  <span class="kw">in</span> 
<span class="ot">&gt;</span>    (e,p<span class="fu">*</span>q)</code></pre></div>
<p>Here <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1251" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1252"><span class="mi" id="MathJax-Span-1253" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-154">p</script></span> and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1254" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.49em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1255"><span class="mi" id="MathJax-Span-1256" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-155">q</script></span> are supposed to be <em>large</em> primes with the same bitlength.</p>
<p><strong>RSA public key cryptography; generation of a private key</strong></p>
<p>Let <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1257" role="math" style="width: 1.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.459em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.52em 1001.46em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1258"><span class="mi" id="MathJax-Span-1259" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1260" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>,</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-156">p,q</script></span> be large primes. Let <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1262" role="math" style="width: 3.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.976em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.52em 1002.98em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1263"><span class="mi" id="MathJax-Span-1264" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1265" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1266" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">p</span><span class="mi" id="MathJax-Span-1267" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mi>p</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-157">n = pq</script></span>.</p>
<p>If <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1268" role="math" style="width: 2.37em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.309em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.19em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1269"><span class="mo" id="MathJax-Span-1270" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1271" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-1272" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1273" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">n</span><span class="mo" id="MathJax-Span-1274" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>e</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-158">(e,n)</script></span> is the public key pair, where <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1275" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1276"><span class="mi" id="MathJax-Span-1277" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-159">n</script></span> is the semi-prime given by <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1278" role="math" style="width: 3.098em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.976em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.52em 1002.98em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1279"><span class="mi" id="MathJax-Span-1280" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1281" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mi" id="MathJax-Span-1282" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">p</span><span class="mi" id="MathJax-Span-1283" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mi>p</mi><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-160">n = pq</script></span>, and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1284" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1285"><span class="mi" id="MathJax-Span-1286" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-161">d</script></span> is the inverse of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1287" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.43em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1288"><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">e</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-162">e</script></span> modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1290" role="math" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.071em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1005.95em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1291"><span class="mo" id="MathJax-Span-1292" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1293" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-1294" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-1295" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-1296" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1297" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1299" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-1300" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span><span class="mo" id="MathJax-Span-1301" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-163">(p-1)(q-1)</script></span>, then <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1302" role="math" style="width: 2.43em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.37em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.25em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-1303"><span class="mo" id="MathJax-Span-1304" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1305" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1306" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1307" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">n</span><span class="mo" id="MathJax-Span-1308" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>d</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-164">(d,n)</script></span> is the private key.</p>
<p>It is believed that the private key is hard to compute from the public key (in the sense that nobody knows how to do this, and it is suspected that it is impossible to find an efficient algorithm for this).</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; rsa_private ::</span>  <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> 
<span class="ot">&gt;</span>                 <span class="ot">-&gt;</span> (<span class="dt">Integer</span>,<span class="dt">Integer</span>)
<span class="ot">&gt;</span> rsa_private p q <span class="fu">=</span> <span class="kw">let</span> 
<span class="ot">&gt;</span>    n <span class="fu">=</span> p <span class="fu">*</span> q
<span class="ot">&gt;</span>    phi <span class="fu">=</span> (p<span class="fu">-</span><span class="dv">1</span>)<span class="fu">*</span>(q<span class="fu">-</span><span class="dv">1</span>)
<span class="ot">&gt;</span>    e <span class="fu">=</span> head [ x <span class="fu">|</span> x <span class="ot">&lt;-</span> [<span class="dv">3</span><span class="fu">..</span>], gcd x phi <span class="fu">==</span> <span class="dv">1</span> ]
<span class="ot">&gt;</span>    d <span class="fu">=</span> invM e phi 
<span class="ot">&gt;</span>   <span class="kw">in</span> 
<span class="ot">&gt;</span>    (d,p<span class="fu">*</span>q)</code></pre></div>
<p><strong>RSA encoding using a generated key pair</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; rsa_encode ::</span> (<span class="dt">Integer</span>,<span class="dt">Integer</span>) <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> 
<span class="ot">&gt;</span> rsa_encode (e,n) <span class="fu">=</span>  \ m <span class="ot">-&gt;</span> exM m e n</code></pre></div>
<p><strong>RSA decoding using a private key</strong></p>
<p>Just use the private key to encode again.</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> rsa_decode <span class="fu">=</span> rsa_encode</code></pre></div>
<p>This gives:</p>
<p>[ (m<sup>e)</sup>{e^{-1}} n = m. ]</p>
<p><strong>A genuine trapdoor function</strong></p>
<div class="figure">
<img src="./Lecture6_files/padlock.jpg" alt="padlock">
<p class="caption">padlock</p>
</div>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; trapdoor ::</span> (<span class="dt">Integer</span>,<span class="dt">Integer</span>) <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> trapdoor <span class="fu">=</span> rsa_encode </code></pre></div>
<hr>
<p><strong>Your Tasks for This Week</strong></p>
<ol style="list-style-type: decimal">
<li><p>Implement fast modular exponentiation. This is one of the key ingredients to primality testing and public key cryptography.</p></li>
<li><p>Test your function for fast modular exponentiation.</p></li>
<li><p>Write a function for generating the composite numbers</p></li>
<li><p>Use this to test Fermat's Primality Algorithm</p></li>
<li><p>Test Fermat's Primality Algorithm for Carmichael numbers</p></li>
<li><p>Use the Miller-Rabin primality check to find large Mersenne primes. Next, check on internet whether the numbers that you found are genuine Mersenne primes</p></li>
<li><p><strong>Bonus</strong> Use the Miller-Rabin primality check to find large pairs of primes and demonstrate how these are used in RSA cryptography.</p></li>
</ol>
<hr>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> secret <span class="fu">=</span> m18
<span class="ot">&gt;</span> bound  <span class="fu">=</span> <span class="dv">131</span></code></pre></div>
<hr>
<div id="references" class="references">
<div id="ref-CormenLeisersonRivest1997:ita">
<p>Cormen, Thomas H., Charles E. Leiserson, and Ronald L. Rivest. 1997. <em>Introduction to Algorithms</em>. MIT Press.</p>
</div>
<div id="ref-DiffieHellman1976:ndic">
<p>Diffie, W., and M. Hellman. 1976. “New Directions in Cryptography.” <em>IEEE Transactions on Information Theory</em> 22 (6): 644–54.</p>
</div>
<div id="ref-DoeEij12:thr2">
<p>Doets, K., and J. van Eijck. 2012. <em>The Haskell Road to Logic, Maths and Programming, Second Edition</em>. Vol. 4. Texts in Computing. London: College Publications.</p>
</div>
<div id="ref-Miller1976:rhatfp">
<p>Miller, Gary L. 1976. “Riemann’s Hypothesis and Tests for Primality.” <em>Journal of Computer and System Sciences</em> 13 (3): 300–317.</p>
</div>
<div id="ref-Rabin1980:paftp">
<p>Rabin, Michael O. 1980. “Probabilistic Algorithm for Testing Primality.” <em>Journal of Number Theory</em> 12 (1): 128–38.</p>
</div>
<div id="ref-RivShaAdl78:amfods">
<p>Rivest, R., A. Shamir, and L. Adleman. 1978. “A Method for Obtaining Digital Signatures and Public-Key Cryptosystems.” <em>Communications of the ACM</em> 21 (2): 120–26.</p>
</div>
</div>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_AMS, sans-serif;"></div></div></body></html>