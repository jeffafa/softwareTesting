<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0068)http://homepages.cwi.nl/~jve/courses/15/testing/lab/Lab6Answers.html -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta name="generator" content="pandoc">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="./Lab6Answers_files/buttondown.css" type="text/css">
  <script src="./Lab6Answers_files/MathJax.js" type="text/javascript"></script>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.6.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.6.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.6-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.6.0') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<h1 id="lab-6-software-specification-and-testing-with-answers">Lab 6 Software Specification and Testing, with Answers</h1>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="kw">module</span> <span class="dt">Lab6Answers</span> <span class="kw">where</span>
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Data.List</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Data.Char</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Data.Bits</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">System.Random</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Lecture6</span> </code></pre></div>
<hr>
<p><strong>Exercise 1</strong></p>
<p>Implement a function</p>
<pre><code> exM :: Integer -&gt; Integer -&gt; Integer -&gt; Integer</code></pre>
<p>that does modular exponentiation of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 1.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.124em 1001.04em 1.156em -999.997em); top: -0.968em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>y</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-1">x^y</script></span> in polynomial time, by repeatedly squaring modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">N</script></span>.</p>
<p>E.g., <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;0.667em&quot; /&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" role="math" style="width: 5.343em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.161em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1005.1em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-10"><span class="msubsup" id="MathJax-Span-11"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="mn" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Main;">33</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-16"><span class="mspace" id="MathJax-Span-17" style="height: 0.003em; vertical-align: 0.003em; width: 0.671em; display: inline-block; overflow: hidden;"></span></span><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.185em;">mod</span><span class="mspace" id="MathJax-Span-19" style="height: 0.003em; vertical-align: 0.003em; width: 0.185em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-20" style="height: 0.003em; vertical-align: 0.003em; width: 0.185em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.185em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msup><mspace width="0.667em"></mspace><mi>mod</mi><mspace width="thinmathspace"></mspace><mspace width="thinmathspace"></mspace><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">x^{33} \mod 5</script></span> can be computed by means of</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;33&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" role="math" style="width: 20.695em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.088em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1020.03em 2.612em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-23"><span class="msubsup" id="MathJax-Span-24"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mn" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Main;">33</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-29"><span class="mspace" id="MathJax-Span-30" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-33" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.185em;">5</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="msubsup" id="MathJax-Span-37" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-39"><span class="mrow" id="MathJax-Span-40"><span class="mn" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-42"><span class="mspace" id="MathJax-Span-43" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-46" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-47" style="font-family: MathJax_Main; padding-left: 0.185em;">5</span><span class="mo" id="MathJax-Span-48" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic; padding-left: 0.246em;">x</span><span class="TeXmathchoice" id="MathJax-Span-51"><span class="mspace" id="MathJax-Span-52" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-55" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.185em;">5</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>33</mn></mrow></msup><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mn>5</mn><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msup><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mn>5</mn><mo stretchy="false">)</mo><mo>×</mo><mi>x</mi><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mn>5</mn><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">
  x^{33} \pmod 5 = x^{32} \pmod 5 \times x \pmod 5. 
</script></span></p>
<p><span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;0.444em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-59" role="math" style="width: 6.01em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.828em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1005.71em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-60"><span class="msubsup" id="MathJax-Span-61"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-63"><span class="mrow" id="MathJax-Span-64"><span class="mn" id="MathJax-Span-65" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-66"><span class="mspace" id="MathJax-Span-67" style="height: 0.003em; vertical-align: 0.003em; width: 0.428em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-70" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msup><mspace width="0.444em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">x^{32} \pmod N</script></span> is computed in five steps by means of repeatedly squaring modulo <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-73" role="math" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.91em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-74"><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">N</script></span>:</p>
<p><span class="math display"><span class="MathJax_Preview" style="color: inherit;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;mod&lt;/mi&gt;&lt;mspace width=&quot;0.333em&quot; /&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" role="math" style="width: 32.709em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.738em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1031.68em 2.612em -999.997em); top: -2.181em; left: 0.003em;"><span class="mrow" id="MathJax-Span-77"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">x</span><span class="TeXmathchoice" id="MathJax-Span-79"><span class="mspace" id="MathJax-Span-80" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-83" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.306em;">→</span><span class="msubsup" id="MathJax-Span-87" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="mn" id="MathJax-Span-89" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-90"><span class="mspace" id="MathJax-Span-91" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-94" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main; padding-left: 0.306em;">→</span><span class="msubsup" id="MathJax-Span-98" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 0.974em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="mn" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-101"><span class="mspace" id="MathJax-Span-102" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-105" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.306em;">→</span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main; padding-left: 0.306em;">…</span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main; padding-left: 0.306em;">→</span><span class="msubsup" id="MathJax-Span-111" style="padding-left: 0.306em;"><span style="display: inline-block; position: relative; width: 1.338em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.55em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.549em;"><span class="texatom" id="MathJax-Span-113"><span class="mrow" id="MathJax-Span-114"><span class="mn" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Main;">32</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-116"><span class="mspace" id="MathJax-Span-117" style="height: 0.003em; vertical-align: 0.003em; width: 0.974em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-120" style="height: 0.003em; vertical-align: 0.003em; width: 0.306em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-122" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.187em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">→</mo><msup><mi>x</mi><mn>2</mn></msup><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">→</mo><msup><mi>x</mi><mn>4</mn></msup><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">→</mo><mo>…</mo><mo stretchy="false">→</mo><msup><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>32</mn></mrow></msup><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-7">
  x \pmod N \rightarrow x^2 \pmod N \rightarrow  x^4 \pmod N \rightarrow  \ldots 
   \rightarrow  x^{32} \pmod N.
</script></span></p>
<p>If this explanation is too concise, look up relevant literature.</p>
<hr>
<p><strong>Answer</strong></p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">exM ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
exM _ <span class="dv">0</span> _ <span class="fu">=</span> <span class="dv">1</span>
exM x y n <span class="fu">=</span> <span class="kw">let</span> 
              z <span class="fu">=</span> exM x (y <span class="ot">`div`</span> <span class="dv">2</span>) n
              w <span class="fu">=</span> multM z z n
            <span class="kw">in</span> 
              <span class="kw">if</span> even y <span class="kw">then</span> w
              <span class="kw">else</span> multM x w n </code></pre></div>
<p>If you use the <code>Data.Bits</code> library, this can be sped up even further:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; exMfast ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> exMfast b e m <span class="fu">=</span> exM' b e m <span class="dv">1</span> <span class="kw">where</span>
<span class="ot">&gt;</span>   exM' _ <span class="dv">0</span> _ r <span class="fu">=</span> r
<span class="ot">&gt;</span>   exM' b e m r <span class="fu">|</span> odd e     <span class="fu">=</span> 
<span class="ot">&gt;</span>                  exM' (b<span class="fu">*</span>b <span class="ot">`mod`</span> m) 
<span class="ot">&gt;</span>                       (Data.Bits.shiftR e <span class="dv">1</span>) m (r<span class="fu">*</span>b <span class="ot">`mod`</span> m)
<span class="ot">&gt;</span>                <span class="fu">|</span> otherwise <span class="fu">=</span> 
<span class="ot">&gt;</span>                  exM' (b<span class="fu">*</span>b <span class="ot">`mod`</span> m) 
<span class="ot">&gt;</span>                       (Data.Bits.shiftR e <span class="dv">1</span>) m r</code></pre></div>
<hr>
<p><strong>Exercise 2</strong></p>
<p>Check that your implementation is more efficient than <code>expM</code> by running a number of relevant tests and documenting the results.</p>
<hr>
<p><strong>Answer</strong></p>
<p>Here you already see a marked difference:</p>
<pre><code> *Lab6Answers&gt; exM 234567 891011 12131415
 694008
 *Lab6Answers&gt; expM 234567 891011 12131415
 694008</code></pre>
<p>If you increase the exponent, one digit at a time, you see that there is a vast difference in efficiency.</p>
<hr>
<p><strong>Exercise 3</strong></p>
<p>In order to test Fermat's Primality Check (as implemented in function <code>prime_test_F</code>), the list of prime numbers generated by Eratosthenes' sieve is useless, for Fermat's Primality Check correctly classify the primes as primes. Where the check can go wrong is on classifying composite numbers; these can slip through the Fermat test.</p>
<p>Write a function <code>composites :: [Integer]</code> that generates the infinite list of composite natural numbers.</p>
<hr>
<p><strong>Answer</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; composites ::</span> [<span class="dt">Integer</span>]
<span class="ot">&gt;</span> composites <span class="fu">=</span> filter (not<span class="fu">.</span>isPrime) [<span class="dv">4</span><span class="fu">..</span>]</code></pre></div>
<hr>
<p><strong>Exercise 4</strong></p>
<p>Use the list of composite numbers to test Fermat's primality check. What is the least composite number that you can find that fools the check, for <code>prime_tests_F k</code> with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-124" role="math" style="width: 4.493em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.372em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1004.31em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-128" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.185em;">2</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.185em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-8">k = 1, 2, 3</script></span> ? What happens if you increase <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">k</script></span>?</p>
<hr>
<p><strong>Answer</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> testF k n <span class="fu">=</span> test prime_tests_F k <span class="dv">0</span> (take n composites)
<span class="ot">&gt;</span> 
<span class="ot">&gt; test ::</span> (<span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span>) 
<span class="ot">&gt;</span>      <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [<span class="dt">Integer</span>] <span class="ot">-&gt;</span> <span class="dt">IO</span>()
<span class="ot">&gt;</span> test primetest k m [] <span class="fu">=</span> print <span class="fu">$</span> show m <span class="fu">++</span> <span class="st">" false positives"</span>
<span class="ot">&gt;</span> test primetest k m (n<span class="fu">:</span>ns) <span class="fu">=</span> 
<span class="ot">&gt;</span>   <span class="kw">do</span> verdict  <span class="ot">&lt;-</span> primetest k n
<span class="ot">&gt;</span>      <span class="kw">if</span> verdict 
<span class="ot">&gt;</span>          <span class="kw">then</span> <span class="kw">do</span> 
<span class="ot">&gt;</span>               print (<span class="st">"false positive on "</span> <span class="fu">++</span> show n)
<span class="ot">&gt;</span>               test primetest k (m<span class="fu">+</span><span class="dv">1</span>) ns
<span class="ot">&gt;</span>          <span class="kw">else</span> test primetest k m ns</code></pre></div>
<p>Testing with this, you find that if you do <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1000.55em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-137"><span class="mn" id="MathJax-Span-138" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-10">4</script></span> Fermat tests per composite number you keep getting false positives on the first 2000 composite numbers:</p>
<pre><code> *Lab6Answers&gt; testF 4 2000
 "false positive on 133"
 "1 false positives"
 *Lab6Answers&gt; testF 4 2000
 "false positive on 1729"
 "1 false positives"
 *Lab6Answers&gt; testF 4 2000
 "false positive on 1105"
 "false positive on 1729"
 "2 false positives"
 *Lab6Answers&gt; testF 4 2000
 "false positive on 645"
 "1 false positives"
 </code></pre>
<p>Increasing the number of tests a bit does help, but not much:</p>
<pre><code> *Lab6Answers&gt; testF 5 2000
 "false positive on 1729"
 "1 false positives"
 *Lab6Answers&gt; testF 5 2000
 "0 false positives"
 *Lab6Answers&gt; testF 5 2000
 "false positive on 561"
 "1 false positives"
 *Lab6Answers&gt; testF 6 2000
 "false positive on 1105"
 "1 false positives"
 *Lab6Answers&gt; testF 6 2000
 "false positive on 1105"
 "1 false positives"
 *Lab6Answers&gt; testF 6 2000
 "0 false positives"</code></pre>
<p>Increasing the number of tests a lot gives better results:</p>
<pre><code>  *Lab6Answers&gt; testF 20 2000
 "0 false positives"
 *Lab6Answers&gt; testF 20 2000
 "0 false positives"
 *Lab6Answers&gt; testF 20 2000
 "0 false positives"
 *Lab6Answers&gt; testF 20 2000
 "0 false positives"
 *Lab6Answers&gt; testF 20 2000
 "0 false positives"
 *Lab6Answers&gt; testF 20 2000
 "0 false positives"
 *Lab6Answers&gt; testF 20 2000
 "0 false positives"
 *Lab6Answers&gt; testF 20 10000
 "0 false positives"</code></pre>
<hr>
<p><strong>Exercise 5</strong></p>
<p>Use the list generated by the following function for a further test of Fermat's primality check.</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; carmichael ::</span> [<span class="dt">Integer</span>]
<span class="ot">&gt;</span> carmichael <span class="fu">=</span> [ (<span class="dv">6</span><span class="fu">*</span>k<span class="fu">+</span><span class="dv">1</span>)<span class="fu">*</span>(<span class="dv">12</span><span class="fu">*</span>k<span class="fu">+</span><span class="dv">1</span>)<span class="fu">*</span>(<span class="dv">18</span><span class="fu">*</span>k<span class="fu">+</span><span class="dv">1</span>) <span class="fu">|</span> 
<span class="ot">&gt;</span>       k <span class="ot">&lt;-</span> [<span class="dv">2</span><span class="fu">..</span>], 
<span class="ot">&gt;</span>       isPrime (<span class="dv">6</span><span class="fu">*</span>k<span class="fu">+</span><span class="dv">1</span>), 
<span class="ot">&gt;</span>       isPrime (<span class="dv">12</span><span class="fu">*</span>k<span class="fu">+</span><span class="dv">1</span>), 
<span class="ot">&gt;</span>       isPrime (<span class="dv">18</span><span class="fu">*</span>k<span class="fu">+</span><span class="dv">1</span>) ]</code></pre></div>
<p>Read the entry on <a href="https://en.wikipedia.org/wiki/Carmichael_number">Carmichael numbers</a> on Wikipedia to explain what you find. If necessary, consult other sources.</p>
<hr>
<p><strong>Answer</strong></p>
<p>Here is the test that we need:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> carmichaelTest k n <span class="fu">=</span> test prime_tests_F k <span class="dv">0</span> (take n carmichael) </code></pre></div>
<p>Running this with <code>carmichaelTest 10 100</code> shows that we get <em>almost</em> always a false positive for the Carmichael numbers from this list.</p>
<p>So why don't we <em>always</em> get false positives? After all, Wikipedia defines the Carmichael numbers as the numbers that fool the Fermat test. The trouble is that the Wikipedia entry on Carmichael numbers has it wrong. The entry says that <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-139" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">n</script></span> is a Carmichael number if <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-142" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-143"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">n</script></span> is composite and <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-145" role="math" style="width: 6.01em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.828em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1005.83em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-146"><span class="msubsup" id="MathJax-Span-147"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.428em;"><span class="mi" id="MathJax-Span-149" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mi>n</mi></msup><mo>≡</mo><mi>b</mi><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">b^n \equiv b \bmod n</script></span> (or, equivalently, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-154" role="math" style="width: 7.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.86em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1006.86em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-155"><span class="msubsup" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 1.823em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.428em;"><span class="texatom" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-161" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-162" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-164" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">b^{n-1} \equiv 1 \bmod n</script></span>), for all <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" role="math" style="width: 0.488em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.488em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.49em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">b</script></span> with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-170" role="math" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.071em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1006.01em 2.37em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-171"><span class="mn" id="MathJax-Span-172" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">b</span><span class="mo" id="MathJax-Span-175" style="font-family: MathJax_Main; padding-left: 0.306em;">&lt;</span><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic; padding-left: 0.306em;">n</span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>&lt;</mo><mi>b</mi><mo>&lt;</mo><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-16">1 < b < n-1</script></span>. This is not correct, as you can easily check with Haskell for the smallest Carmichael number, which is <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;561&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" role="math" style="width: 1.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.52em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1001.46em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-180"><span class="mn" id="MathJax-Span-181" style="font-family: MathJax_Main;">561</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>561</mn></math></span></span><script type="math/tex" id="MathJax-Element-17">561</script></span>.</p>
<pre><code> *Lab6Answers&gt; exM 3 560 561
 375</code></pre>
<p>The correct definition is (from <a href="http://mathworld.wolfram.com/CarmichaelNumber.html">wolfram</a>: A Carmichael number is an odd composite number <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-182" role="math" style="width: 0.671em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.61em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.61em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-183"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">n</script></span> which satisfies Fermat's little theorem <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-185" role="math" style="width: 7.224em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.981em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1006.98em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-186"><span class="msubsup" id="MathJax-Span-187"><span style="display: inline-block; position: relative; width: 1.945em; height: 0px;"><span style="position: absolute; clip: rect(3.401em 1000.49em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.549em;"><span class="texatom" id="MathJax-Span-189"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-193" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main; padding-left: 0.306em;">≡</span><span class="mn" id="MathJax-Span-195" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main; padding-left: 0.306em; padding-right: 0.306em;">mod</span><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><mn>1</mn><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">a^{n-1} \equiv 1 \bmod n</script></span> for any <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-198" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">a</script></span> with <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;gcd&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-201" role="math" style="width: 5.95em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.768em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1005.71em 2.552em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-202"><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main;">gcd</span><span class="mo" id="MathJax-Span-204" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-206" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">n</span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main; padding-left: 0.306em;">=</span><span class="mn" id="MathJax-Span-210" style="font-family: MathJax_Main; padding-left: 0.306em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">gcd</mo><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-21">\gcd(a,n) = 1</script></span>.</p>
<hr>
<p><strong>Exercise 6</strong></p>
<p>Use the list from the previous exercise to test the Miller-Rabin primality check. What do you find?</p>
<hr>
<p><strong>Answer</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> testM k n <span class="fu">=</span> test primeMR k <span class="dv">0</span> (take n carmichael)</code></pre></div>
<p>This gives a dramatic improvement:</p>
<pre><code> *Lab6Answers&gt; testM 2 100
 "false positive on 172947529"
 "1 false positives"
 *Lab6Answers&gt; testM 3 100
 "false positive on 56052361"
 "false positive on 1396066334401"
 "2 false positives"
 *Lab6Answers&gt; testM 3 100
 "0 false positives"
 *Lab6Answers&gt; testM 3 100
 "0 false positives"
 *Lab6Answers&gt; testM 3 100
 "0 false positives"
 *Lab6Answers&gt; testM 3 100
 "0 false positives"
 *Lab6Answers&gt; testM 3 100
 "0 false positives"
 </code></pre>
<hr>
<p><strong>Exercise 6</strong></p>
<p>You can use the Miller-Rabin primality check to discover some large Mersenne primes. The recipe: take a prime <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-211" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.338em 1000.55em 2.309em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-212"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">p</script></span>, and use the Miller-Rabin algorithm to check whether <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-214" role="math" style="width: 2.855em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.734em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em 1002.67em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-215"><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 0.913em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-217" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.488em;"><span class="mi" id="MathJax-Span-218" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-220" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>p</mi></msup><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-23">2^p - 1</script></span> is also prime. Find information about Mersenne primes on internet and check whether the numbers that you found are genuine Mersenne primes. Report on your findings.</p>
<hr>
<p><strong>Answer</strong></p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> findMersennes k n <span class="fu">=</span> findM k <span class="dv">0</span> (take n primes)
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> findM k m [] <span class="fu">=</span> print <span class="fu">$</span> show m <span class="fu">++</span> <span class="st">" Mersenne primes found "</span>
<span class="ot">&gt;</span> findM k m (n<span class="fu">:</span>ns) <span class="fu">=</span> 
<span class="ot">&gt;</span>   <span class="kw">do</span> ok <span class="ot">&lt;-</span> primeMR k (<span class="dv">2</span><span class="fu">^</span>n <span class="fu">-</span><span class="dv">1</span>)
<span class="ot">&gt;</span>      <span class="kw">if</span> ok 
<span class="ot">&gt;</span>        <span class="kw">then</span> <span class="kw">do</span> 
<span class="ot">&gt;</span>          print (<span class="st">"Mersenne prime found for "</span> <span class="fu">++</span> show n)
<span class="ot">&gt;</span>          findM k (m<span class="fu">+</span><span class="dv">1</span>) ns
<span class="ot">&gt;</span>        <span class="kw">else</span> findM k m ns</code></pre></div>
<p>Using interpreted bytecode this finds the first 23 Mersenne primes in a few hours. Using compiled object code (see <a href="https://downloads.haskell.org/~ghc/7.0.2/docs/">the ghc documentation</a> you can speed up the search process, and find some more. You can check in the course notes and on internet that the following are all correct:</p>
<pre><code> *Lab6Answers&gt; findMersennes 10 4000
 "Mersenne prime found for 2"
 "Mersenne prime found for 3"
 "Mersenne prime found for 5"
 "Mersenne prime found for 7"
 "Mersenne prime found for 13"
 "Mersenne prime found for 17"
 "Mersenne prime found for 19"
 "Mersenne prime found for 31"
 "Mersenne prime found for 61"
 "Mersenne prime found for 89"
 "Mersenne prime found for 107"
 "Mersenne prime found for 127"
 "Mersenne prime found for 521"
 "Mersenne prime found for 607"
 "Mersenne prime found for 1279"
 "Mersenne prime found for 2203"
 "Mersenne prime found for 2281"
 "Mersenne prime found for 3217"
 "Mersenne prime found for 4253"
 "Mersenne prime found for 4423"
 "Mersenne prime found for 9689"
 "Mersenne prime found for 9941"
 "Mersenne prime found for 11213"
 "Mersenne prime found for 19937"
 "Mersenne prime found for 21701"
 "Mersenne prime found for 23209"
 "26 Mersenne primes found "</code></pre>
<p>Given that (Oct 2015) there are only <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;48&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-221" role="math" style="width: 1.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.035em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.277em 1000.97em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-222"><span class="mn" id="MathJax-Span-223" style="font-family: MathJax_Main;">48</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>48</mn></math></span></span><script type="math/tex" id="MathJax-Element-24">48</script></span> Mersenne primes known (see <a href="http://en.wikipedia.org/wiki/Mersenne_prime">Mersenne prime</a> this is not bad at all. You can also start the search at a specific number:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; primesFrom ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> [<span class="dt">Integer</span>]
<span class="ot">&gt;</span> primesFrom n <span class="fu">=</span> skipBelow n primes <span class="kw">where</span> 
<span class="ot">&gt;</span>   skipBelow n (p<span class="fu">:</span>ps) <span class="fu">=</span> <span class="kw">if</span> n <span class="fu">&lt;=</span> p <span class="kw">then</span> (p<span class="fu">:</span>ps) <span class="kw">else</span> skipBelow n ps </code></pre></div>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> lookForMersenne k n bound <span class="fu">=</span> findM k <span class="dv">0</span> (take n <span class="fu">$</span> primesFrom bound)</code></pre></div>
<p>Whether you can also recognize the next Mersenne prime, <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;44497&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-224" role="math" style="width: 4.311em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.19em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1004.13em 2.309em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-225"><span class="msubsup" id="MathJax-Span-226"><span style="display: inline-block; position: relative; width: 2.37em; height: 0px;"><span style="position: absolute; clip: rect(3.158em 1000.43em 4.19em -999.997em); top: -4.002em; left: 0.003em;"><span class="mn" id="MathJax-Span-227" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.488em;"><span class="texatom" id="MathJax-Span-228"><span class="mrow" id="MathJax-Span-229"><span class="mn" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Main;">44497</span></span></span><span style="display: inline-block; width: 0px; height: 4.008em;"></span></span></span></span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mn" id="MathJax-Span-232" style="font-family: MathJax_Main; padding-left: 0.246em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>44497</mn></mrow></msup><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-25">2^{44497}-1</script></span>, depends on your implementation of fast exponentiation. The version given above is not fast enough for this ...</p>
<hr>
<p><strong>Exercise 7 (Bonus)</strong></p>
<p>For RSA public key cryptography, one needs pairs of large primes with the same bitlength. Such pairs of primes can be found by trial-and-error using the Miller-Rabin primality check. Write a function for this, and demonstrate how a pair <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-233" role="math" style="width: 1.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.459em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.52em 1001.46em 2.491em -999.997em); top: -2.121em; left: 0.003em;"><span class="mrow" id="MathJax-Span-234"><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math-italic;">p</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic; padding-left: 0.185em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo>,</mo><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">p,q</script></span> that you found can be used for public key encoding and decoding.</p>
<hr>
<p><strong>Answer</strong> Here is a function for finding primes of <span class="math inline"><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-238" role="math" style="width: 0.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.549em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.095em 1000.55em 2.127em -999.997em); top: -1.939em; left: 0.003em;"><span class="mrow" id="MathJax-Span-239"><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 1.945em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left-width: 0px; border-left-style: solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">k</script></span> bits long:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; findPrime ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Integer</span> 
<span class="ot">&gt;</span> findPrime k <span class="fu">=</span> <span class="kw">do</span> 
<span class="ot">&gt;</span>    p  <span class="ot">&lt;-</span> getStdRandom (randomR (<span class="dv">2</span><span class="fu">^</span>(k<span class="fu">-</span><span class="dv">1</span>), <span class="dv">2</span><span class="fu">^</span>k <span class="fu">-</span> <span class="dv">1</span>))
<span class="ot">&gt;</span>    ok <span class="ot">&lt;-</span> primeMR <span class="dv">10</span> p 
<span class="ot">&gt;</span>    <span class="kw">if</span> ok <span class="kw">then</span> return p <span class="kw">else</span> findPrime k</code></pre></div>
<p>Use this for finding prime pairs of a given length:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; findPair ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> (<span class="dt">Integer</span>,<span class="dt">Integer</span>)
<span class="ot">&gt;</span> findPair k <span class="fu">=</span> <span class="kw">do</span> 
<span class="ot">&gt;</span>    p <span class="ot">&lt;-</span> findPrime k
<span class="ot">&gt;</span>    q <span class="ot">&lt;-</span> findPrime k
<span class="ot">&gt;</span>    <span class="kw">if</span> p <span class="fu">/=</span> q <span class="kw">then</span> return (p,q) <span class="kw">else</span> findPair k</code></pre></div>
<p>Here is how to generate prime pairs of 100 bits long:</p>
<pre><code> *Lab6Answers&gt; findPair 100
 (1019932108723427450054829064429,1157194308921827490559355467451)</code></pre>
<p>The demonstration of how to use this for the generation of a pair consisting of a public RSA key and a private RSA key:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; rsaKeyGen ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ((<span class="dt">Integer</span>,<span class="dt">Integer</span>),(<span class="dt">Integer</span>,<span class="dt">Integer</span>))
<span class="ot">&gt;</span> rsaKeyGen k <span class="fu">=</span> <span class="kw">do</span> 
<span class="ot">&gt;</span>     (p,q)  <span class="ot">&lt;-</span> findPair k
<span class="ot">&gt;</span>     return (rsa_public p q, rsa_private p q)</code></pre></div>
<p>Generating a key pair:</p>
<pre><code> *Lab6Answers&gt; rsaKeyGen 100
 ((7,833701862632724241224041328200639203708632588517636435099353),
  (714601596542335063906321138456068311891398198707455693859103,
   833701862632724241224041328200639203708632588517636435099353))</code></pre>
<p>Code for converting strings to integers and back:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; str2int ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> str2int [] <span class="fu">=</span> <span class="dv">0</span>
<span class="ot">&gt;</span> str2int (c <span class="fu">:</span> cs) <span class="fu">=</span> 
<span class="ot">&gt;</span>   shift (toInteger (ord c)) (<span class="dv">8</span> <span class="fu">*</span> (length cs)) <span class="fu">.|.</span> str2int cs
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> <span class="co">-- Get the last n bits of an integer x</span>
<span class="ot">&gt; lastNBits ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>
<span class="ot">&gt;</span> lastNBits x n <span class="fu">=</span> xor (shiftL (shiftR x n) n) x
<span class="ot">&gt;</span> 
<span class="ot">&gt; int2str ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
<span class="ot">&gt;</span> int2str <span class="dv">0</span> <span class="fu">=</span> <span class="st">""</span>
<span class="ot">&gt;</span> int2str x <span class="fu">=</span> int2str (shiftR x <span class="dv">8</span>) 
<span class="ot">&gt;</span>             <span class="fu">++</span> [chr (fromInteger (lastNBits x <span class="dv">8</span>))]</code></pre></div>
<p>Encoding and decoding with an RSA key:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; rsaDemo ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()
<span class="ot">&gt;</span> rsaDemo message <span class="fu">=</span> <span class="kw">do</span> 
<span class="ot">&gt;</span>    <span class="kw">let</span> x <span class="fu">=</span> str2int message
<span class="ot">&gt;</span>    ((e,n),(d,_)) <span class="ot">&lt;-</span> rsaKeyGen <span class="dv">300</span>
<span class="ot">&gt;</span>    <span class="kw">let</span> c <span class="fu">=</span> rsa_encode (e,n) x
<span class="ot">&gt;</span>    <span class="kw">let</span> m <span class="fu">=</span> rsa_decode (d,n) c
<span class="ot">&gt;</span>    <span class="kw">let</span> transcript <span class="fu">=</span> int2str m
<span class="ot">&gt;</span>    putStr <span class="fu">$</span> show message <span class="fu">++</span> <span class="st">"\n\n"</span>
<span class="ot">&gt;</span>    putStr <span class="fu">$</span> show x <span class="fu">++</span> <span class="st">"\n\n"</span>
<span class="ot">&gt;</span>    putStr <span class="fu">$</span> show c <span class="fu">++</span> <span class="st">"\n\n"</span>
<span class="ot">&gt;</span>    putStr <span class="fu">$</span> show m <span class="fu">++</span> <span class="st">"\n\n"</span>
<span class="ot">&gt;</span>    putStr <span class="fu">$</span> show transcript <span class="fu">++</span> <span class="st">"\n\n"</span></code></pre></div>
<pre><code> *Lab6Answers&gt; rsaDemo "dit is geheim!"
 "dit is geheim!"

 2036595856873902492754373121764641

 33874234988711619905028716639068053633770022623530991164201869064
 63552742639606648822278048591069942430052126416886285304839426722
 788841754657569702559890716122616601218243969050226

 2036595856873902492754373121764641

 "dit is geheim!"

 *Lab6Answers&gt; </code></pre>
<hr>
<div class="references">

</div>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Main, sans-serif;"></div></div></body></html>